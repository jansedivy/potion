/**
 * potion - v0.6.2
 * Copyright (c) 2014, Jan Sedivy
 *
 * Compiled: 2014-07-28
 *
 * potion is licensed under the MIT License.
 */
!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Potion=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("./src/engine");b.exports={init:function(a,b){var d=new c(a,b);return d.game},Animation:a("./src/animation")}},{"./src/animation":4,"./src/engine":6}],2:[function(b,c,d){!function(){var b={},c=null,e=!0,f=!1;try{"undefined"!=typeof AudioContext?c=new AudioContext:"undefined"!=typeof webkitAudioContext?c=new webkitAudioContext:e=!1}catch(g){e=!1}if(!e)if("undefined"!=typeof Audio)try{new Audio}catch(g){f=!0}else f=!0;if(e){var h=void 0===c.createGain?c.createGainNode():c.createGain();h.gain.value=1,h.connect(c.destination)}var i=function(){this._volume=1,this._muted=!1,this.usingWebAudio=e,this.noAudio=f,this._howls=[]};i.prototype={volume:function(a){var b=this;if(a=parseFloat(a),a>=0&&1>=a){b._volume=a,e&&(h.gain.value=a);for(var c in b._howls)if(b._howls.hasOwnProperty(c)&&b._howls[c]._webAudio===!1)for(var d=0;d<b._howls[c]._audioNode.length;d++)b._howls[c]._audioNode[d].volume=b._howls[c]._volume*b._volume;return b}return e?h.gain.value:b._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){var b=this;b._muted=a,e&&(h.gain.value=a?0:b._volume);for(var c in b._howls)if(b._howls.hasOwnProperty(c)&&b._howls[c]._webAudio===!1)for(var d=0;d<b._howls[c]._audioNode.length;d++)b._howls[c]._audioNode[d].muted=a}};var j=new i,k=null;if(!f){k=new Audio;var l={mp3:!!k.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!k.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!k.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!k.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(k.canPlayType("audio/x-m4a;")||k.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(k.canPlayType("audio/x-mp4;")||k.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!k.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var m=function(a){var b=this;b._autoplay=a.autoplay||!1,b._buffer=a.buffer||!1,b._duration=a.duration||0,b._format=a.format||null,b._loop=a.loop||!1,b._loaded=!1,b._sprite=a.sprite||{},b._src=a.src||"",b._pos3d=a.pos3d||[0,0,-.5],b._volume=void 0!==a.volume?a.volume:1,b._urls=a.urls||[],b._rate=a.rate||1,b._model=a.model||null,b._onload=[a.onload||function(){}],b._onloaderror=[a.onloaderror||function(){}],b._onend=[a.onend||function(){}],b._onpause=[a.onpause||function(){}],b._onplay=[a.onplay||function(){}],b._onendTimer=[],b._webAudio=e&&!b._buffer,b._audioNode=[],b._webAudio&&b._setupAudioNode(),j._howls.push(b),b.load()};if(m.prototype={load:function(){var a=this,c=null;if(f)return void a.on("loaderror");for(var d=0;d<a._urls.length;d++){var e,g;if(a._format)e=a._format;else{if(g=a._urls[d].toLowerCase().split("?")[0],e=g.match(/.+\.([^?]+)(\?|$)/),e=e&&e.length>=2?e:g.match(/data\:audio\/([^?]+);/),!e)return void a.on("loaderror");e=e[1]}if(l[e]){c=a._urls[d];break}}if(!c)return void a.on("loaderror");if(a._src=c,a._webAudio)n(a,c);else{var h=new Audio;h.addEventListener("error",function(){h.error&&4===h.error.code&&(i.noAudio=!0),a.on("loaderror",{type:h.error?h.error.code:0})},!1),a._audioNode.push(h),h.src=c,h._pos=0,h.preload="auto",h.volume=j._muted?0:a._volume*j.volume(),b[c]=a;var k=function(){a._duration=Math.ceil(10*h.duration)/10,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play(),h.removeEventListener("canplaythrough",k,!1)};h.addEventListener("canplaythrough",k,!1),h.load()}return a},urls:function(a){var b=this;return a?(b.stop(),b._urls="string"==typeof a?[a]:a,b._loaded=!1,b.load(),b):b._urls},play:function(a,b){var d=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(e){e._sprite=a;var f,g=e._pos>0?e._pos:d._sprite[a][0]/1e3,h=d._sprite[a][1]/1e3-e._pos,i=!(!d._loop&&!d._sprite[a][2]),k="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){var b={id:k,sprite:a,loop:i};f=setTimeout(function(){!d._webAudio&&i&&d.stop(b.id).play(a,b.id),d._webAudio&&!i&&(d._nodeById(b.id).paused=!0,d._nodeById(b.id)._pos=0),d._webAudio||i||d.stop(b.id),d.on("end",k)},1e3*h),d._onendTimer.push({timer:f,id:b.id})}(),d._webAudio){var l=d._sprite[a][0]/1e3,m=d._sprite[a][1]/1e3;e.id=k,e.paused=!1,p(d,[i,l,m],k),d._playStart=c.currentTime,e.gain.value=d._volume,void 0===e.bufferSource.start?e.bufferSource.noteGrainOn(0,g,h):e.bufferSource.start(0,g,h)}else{if(4!==e.readyState&&(e.readyState||!navigator.isCocoonJS))return d._clearEndTimer(k),function(){var c=d,f=a,g=b,h=e,i=function(){c.play(f,g),h.removeEventListener("canplaythrough",i,!1)};h.addEventListener("canplaythrough",i,!1)}(),d;e.readyState=4,e.id=k,e.currentTime=g,e.muted=j._muted||e.muted,e.volume=d._volume*j.volume(),setTimeout(function(){e.play()},0)}return d.on("play"),"function"==typeof b&&b(k),d}),d):("function"==typeof b&&b(),d):(d.on("load",function(){d.play(a,b)}),d)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,a),b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0,void 0===c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0,void 0===c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||(c.pause(),c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1),b},volume:function(a,b){var c=this;if(a=parseFloat(a),a>=0&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();return d&&(c._webAudio?d.gain.value=a:d.volume=a*j.volume()),c}return c._volume},loop:function(a){var b=this;return"boolean"==typeof a?(b._loop=a,b):b._loop},sprite:function(a){var b=this;return"object"==typeof a?(b._sprite=a,b):b._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=b?d._nodeById(b):d._activeNode();if(e)return a>=0?(d.pause(b),e._pos=a,d.play(e._sprite,b),d):d._webAudio?e._pos+(c.currentTime-d._playStart):e.currentTime;if(a>=0)return d;for(var f=0;f<d._audioNode.length;f++)if(d._audioNode[f].paused&&4===d._audioNode[f].readyState)return d._webAudio?d._audioNode[f]._pos:d._audioNode[f].currentTime},pos3d:function(a,b,c,d){var e=this;if(b=void 0!==b&&b?b:0,c=void 0!==c&&c?c:-.5,!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(!(a>=0||0>a))return e._pos3d;if(e._webAudio){var f=d?e._nodeById(d):e._activeNode();f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c),f.panner.panningModel=e._model||"HRTF")}return e},fade:function(a,b,c,d,e){var f=this,g=Math.abs(a-b),h=a>b?"down":"up",i=g/.01,j=c/i;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var k=1;i>=k;k++)!function(){var a=f._volume+("up"===h?.01:-.01)*k,c=Math.round(1e3*a)/1e3,g=b;setTimeout(function(){f.volume(c,e),c===g&&d&&d()},j*k)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c(),e.pause(d),e.on("end")},d)},_nodeById:function(a){for(var b=this,c=b._audioNode[0],d=0;d<b._audioNode.length;d++)if(b._audioNode[d].id===a){c=b._audioNode[d];break}return c},_activeNode:function(){for(var a=this,b=null,c=0;c<a._audioNode.length;c++)if(!a._audioNode[c].paused){b=a._audioNode[c];break}return a._drainPool(),b},_inactiveNode:function(a){for(var b=this,c=null,d=0;d<b._audioNode.length;d++)if(b._audioNode[d].paused&&4===b._audioNode[d].readyState){a(b._audioNode[d]),c=!0;break}if(b._drainPool(),!c){var e;b._webAudio?(e=b._setupAudioNode(),a(e)):(b.load(),e=b._audioNode[b._audioNode.length-1],e.addEventListener(navigator.isCocoonJS?"canplaythrough":"loadedmetadata",function(){a(e)}))}},_drainPool:function(){var a,b=this,c=0;for(a=0;a<b._audioNode.length;a++)b._audioNode[a].paused&&c++;for(a=b._audioNode.length-1;a>=0&&!(5>=c);a--)b._audioNode[a].paused&&(b._webAudio&&b._audioNode[a].disconnect(0),c--,b._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=this,c=0,d=0;d<b._onendTimer.length;d++)if(b._onendTimer[d].id===a){c=d;break}var e=b._onendTimer[c];e&&(clearTimeout(e.timer),b._onendTimer.splice(c,1))},_setupAudioNode:function(){var a=this,b=a._audioNode,d=a._audioNode.length;return b[d]=void 0===c.createGain?c.createGainNode():c.createGain(),b[d].gain.value=a._volume,b[d].paused=!0,b[d]._pos=0,b[d].readyState=4,b[d].connect(h),b[d].panner=c.createPanner(),b[d].panner.panningModel=a._model||"equalpower",b[d].panner.setPosition(a._pos3d[0],a._pos3d[1],a._pos3d[2]),b[d].panner.connect(b[d]),b[d]},on:function(a,b){var c=this,d=c["_on"+a];if("function"==typeof b)d.push(b);else for(var e=0;e<d.length;e++)b?d[e].call(c,b):d[e].call(c);return c},off:function(a,b){for(var c=this,d=c["_on"+a],e=""+b,f=0;f<d.length;f++)if(e===""+d[f]){d.splice(f,1);break}return c},unload:function(){for(var a=this,c=a._audioNode,d=0;d<a._audioNode.length;d++)c[d].paused||a.stop(c[d].id),a._webAudio?c[d].disconnect(0):c[d].src="";for(d=0;d<a._onendTimer.length;d++)clearTimeout(a._onendTimer[d].timer);var e=j._howls.indexOf(a);null!==e&&e>=0&&j._howls.splice(e,1),delete b[a._src],a=null}},e)var n=function(a,d){if(d in b)a._duration=b[d].duration,o(a);else{var e=new XMLHttpRequest;e.open("GET",d,!0),e.responseType="arraybuffer",e.onload=function(){c.decodeAudioData(e.response,function(c){c&&(b[d]=c,o(a,c))},function(){a.on("loaderror")})},e.onerror=function(){a._webAudio&&(a._buffer=!0,a._webAudio=!1,a._audioNode=[],delete a._gainNode,a.load())};try{e.send()}catch(f){e.onerror()}}},o=function(a,b){a._duration=b?b.duration:a._duration,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play()},p=function(a,d,e){var f=a._nodeById(e);f.bufferSource=c.createBufferSource(),f.bufferSource.buffer=b[a._src],f.bufferSource.connect(f.panner),f.bufferSource.loop=d[0],d[0]&&(f.bufferSource.loopStart=d[1],f.bufferSource.loopEnd=d[1]+d[2]),f.bufferSource.playbackRate.value=a._rate};"function"==typeof a&&a.amd&&a(function(){return{Howler:j,Howl:m}}),"undefined"!=typeof d&&(d.Howler=j,d.Howl=m),"undefined"!=typeof window&&(window.Howler=j,window.Howl=m)}()},{}],3:[function(a,b){var c=b.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(a,b){var c=function(a,b,c,d){this.image=a,this.width=b,this.height=c,this.columns=d,this.state=0,this.indexX=0,this.indexY=0,this.offsetX=0,this.offsetY=0};c.prototype.setIndexes=function(a,b){this.setIndexX(a),this.setIndexY(b)},c.prototype.setIndexX=function(a){this.indexX=a,this.offsetX=this.width*this.indexX},c.prototype.setIndexY=function(a){this.indexY=a,this.offsetY=this.height*this.indexY},c.prototype.setState=function(a){this.state=a;var b=this.state,c=0;this.columns&&(b=this.state%this.columns,c=Math.floor(this.state/this.columns)),this.setIndexX(b),this.setIndexY(c)},b.exports=c},{}],5:[function(a,b){(function(c){var d=a("./utils");a("../lib/howler.min.js");var e=function(){this.isLoading=!1,this.itemsCount=0,this.loadedItemsCount=0,this._xhr=new XMLHttpRequest,this._thingsToLoad=0,this._data={},this.callback=null,this._toLoad=[]};e.prototype.onload=function(a){this.callback=a,0===this._thingsToLoad?(this.isLoading=!1,c.nextTick(function(){a()})):this.nextFile()},e.prototype.get=function(a){return this._data[a]},e.prototype._handleCustomLoading=function(a){var b=this,c=function(a,c){b._save(a,c)};a(c)},e.prototype.load=function(a,b,c){this.isLoading=!0,this.itemsCount+=1,this._thingsToLoad+=1,this._toLoad.push({type:a,url:b,callback:c})},e.prototype.nextFile=function(){var a=this._toLoad.shift();if(a){var b=a.type,c=a.url,e=a.callback,f=this;if(d.isFunction(b))return void this._handleCustomLoading(b);b=b.toLowerCase();var g=this._xhr;switch(b){case"json":g.open("GET",c,!0),g.responseType="text",g.onload=function(){var a=JSON.parse(this.response);f._save(c,a,e)},g.onerror=function(){f._error(b,c)},g.send();break;case"mp3":case"music":case"sound":var h=new Howl({urls:[c],onload:function(){f._save(c,h,e)},onloaderror:function(){f._error(b,c)}});break;case"image":case"texture":case"sprite":var i=new Image;i.onload=function(){f._save(c,i,e)},i.onerror=function(){f._error(b,c)},i.src=c;break;default:g.open("GET",c,!0),g.responseType="text",g.onload=function(){var a=this.response;f._save(c,a,e)},g.onerror=function(){f._error(b,c)},g.send()}}},e.prototype._error=function(a,b){console.warn('Error loading "'+a+'" asset with url '+b),this.nextFile()},e.prototype._save=function(a,b,c){this._data[a]=b,c&&c(b),this.finishedOneFile()},e.prototype.finishedOneFile=function(){if(this.nextFile(),this._thingsToLoad-=1,0===this._thingsToLoad){var a=this;setTimeout(function(){a.callback(),a.isLoading=!1},0)}},b.exports=e}).call(this,a("/Volumes/Macintosh HD/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"../lib/howler.min.js":2,"./utils":13,"/Volumes/Macintosh HD/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":3}],6:[function(a,b){a("./raf-polyfill")();var c=a("./game"),d=a("./time"),e=function(a,b){var e=function(a){c.call(this,a)};e.prototype=Object.create(c.prototype);for(var f in b)e.prototype[f]=b[f];this.game=new e(a),this.tickFunc=function(a){return function(){a.tick()}}(this),this.preloaderTickFunc=function(a){return function(){a._preloaderTick()}}(this),this.setupCanvasSize(),this.strayTime=0,this._time=d.now(),this.game.assets.onload(function(){this.start(),window.cancelAnimationFrame(this.preloaderId),window.requestAnimationFrame(this.tickFunc)}.bind(this)),this.game.assets.isLoading&&(this.preloaderId=window.requestAnimationFrame(this.preloaderTickFunc))};e.prototype.addEvents=function(){var a=this;window.addEventListener("resize",function(){a.setupCanvasSize()}),window.addEventListener("blur",function(){a.game.input.resetKeys(),a.game.blur()}),window.addEventListener("focus",function(){a.game.input.resetKeys(),a.game.focus()})},e.prototype.setupCanvasSize=function(){this.game.resize(),this.game.video.width=this.game.canvas.width=this.game.width,this.game.video.height=this.game.canvas.height=this.game.height,this.game.config.useRetina&&this.game.isRetina&&this.game.video.scaleCanvas(2)},e.prototype.start=function(){this.game.init(),this.game.config.addInputEvents&&this.addEvents()},e.prototype.tick=function(){window.requestAnimationFrame(this.tickFunc);var a=d.now(),b=(a-this._time)/1e3;this._time=a,this.update(b),this.game.exitUpdate(b),this.render()},e.prototype._preloaderTick=function(){this.preloaderId=window.requestAnimationFrame(this.preloaderTickFunc);var a=d.now(),b=(a-this._time)/1e3;this._time=a,this.game.config.showPreloader&&(this.game.video.ctx&&this.game.video.ctx.clearRect(0,0,this.game.width,this.game.height),this.game.preloading(b))},e.prototype.update=function(a){if(a>this.game.config.mapStepTime&&(a=this.game.config.mapStepTime),this.game.config.fixedStep)for(this.strayTime=this.strayTime+a;this.strayTime>=this.game.config.stepTime;)this.strayTime=this.strayTime-this.game.config.stepTime,this.game.update(this.game.config.stepTime);else this.game.update(a)},e.prototype.render=function(){this.game.video.ctx&&this.game.video.ctx.clearRect(0,0,this.game.width,this.game.height),this.game.render()},b.exports=e},{"./game":7,"./raf-polyfill":10,"./time":12}],7:[function(a,b){var c=a("./video"),d=a("./input"),e=a("./assets"),f=a("./retina"),g=function(a){this.canvas=a,this.width=300,this.height=300,this.assets=new e,this.isRetina=f(),this.config={useRetina:!0,initializeCanvas:!0,initializeVideo:!0,addInputEvents:!0,showPreloader:!0,fixedStep:!0,stepTime:.01666,mapStepTime:.06},this.configure(),this.config.addInputEvents&&(this.input=new d(this)),this.config.initializeVideo&&(this.video=new c(a,this.config))};g.prototype.init=function(){},g.prototype.configure=function(){},g.prototype.resize=function(){},g.prototype.render=function(){},g.prototype.update=function(){},g.prototype.exitUpdate=function(){},g.prototype.mousemove=function(){},g.prototype.focus=function(){},g.prototype.click=function(){},g.prototype.mousedown=function(){},g.prototype.mouseup=function(){},g.prototype.keydown=function(){},g.prototype.keyup=function(){},g.prototype.blur=function(){},g.prototype.preloading=function(a){if(this.video||this.video.ctx){void 0===this._preloaderWidth&&(this._preloaderWidth=0);var b=Math.max(0,Math.min(1,this.assets.loadedItemsCount/this.assets.itemsCount)),c=Math.min(2*this.width/3,300),d=20,e=(this.height-d)/2,f=(this.width-c)/2,g=c*b;this._preloaderWidth=this._preloaderWidth+(g-this._preloaderWidth)*a*10,this.video.ctx.save(),this.video.ctx.fillStyle="#a9c848",this.video.ctx.fillRect(0,0,this.width,this.height),this.video.ctx.fillStyle="#88a237",this.video.ctx.fillRect(f,e,c,d),this.video.ctx.fillStyle="#f6ffda",this.video.ctx.fillRect(f,e,this._preloaderWidth,d),this.video.ctx.restore()}},b.exports=g},{"./assets":5,"./input":8,"./retina":11,"./video":14}],8:[function(a,b){var c=a("./keys"),d=function(a){this.keys={},this.canControlKeys=!0,this.mouse={isDown:!1,button:null,x:null,y:null},this._addEvents(a)};d.prototype.resetKeys=function(){this.keys={}},d.prototype.isKeyDown=function(a){if(null==a)return!1;if(this.canControlKeys){var b=Number.isInteger(a)?a:c[a.toUpperCase()];return this.keys[b]}},d.prototype._addEvents=function(a){var b=this,c=a.canvas;c.addEventListener("mousemove",function(d){var e=void 0===d.offsetX?d.layerX-c.offsetLeft:d.offsetX,f=void 0===d.offsetY?d.layerY-c.offsetTop:d.offsetY;a.mousemove(e,f),b.mouse.x=e,b.mouse.y=f}),c.addEventListener("click",function(b){b.preventDefault();var d=void 0===b.offsetX?b.layerX-c.offsetLeft:b.offsetX,e=void 0===b.offsetY?b.layerY-c.offsetTop:b.offsetY;a.click(d,e,b.button)}),c.addEventListener("mouseup",function(d){d.preventDefault();var e=void 0===d.offsetX?d.layerX-c.offsetLeft:d.offsetX,f=void 0===d.offsetY?d.layerY-c.offsetTop:d.offsetY;b.mouse.button=d.button,b.mouse.isDown=!1,a.mouseup(e,f,d.button)},!1),c.addEventListener("mousedown",function(d){d.preventDefault();var e=void 0===d.offsetX?d.layerX-c.offsetLeft:d.offsetX,f=void 0===d.offsetY?d.layerY-c.offsetTop:d.offsetY;b.mouse.x=e,b.mouse.y=f,b.mouse.button=d.button,b.mouse.isDown=!0,a.mousedown(e,f,d.button)},!1);var d=null,e=null;c.addEventListener("touchstart",function(a){var c=a.layerX,f=a.layerY;d=c,e=f,b.mouse.x=c,b.mouse.y=f,b.mouse.isDown=!0}),c.addEventListener("touchmove",function(c){c.preventDefault();var d=c.layerX,e=c.layerY;a.mousemove(d,e),b.mouse.x=d,b.mouse.y=e}),c.addEventListener("touchend",function(f){f.preventDefault(),b.mouse.isDown=!1;for(var g=0,h=f.changedTouches.length;h>g;g++){var i=f.changedTouches[g],j=i.pageX-c.offsetLeft,k=i.pageY-c.offsetTop,l=0,m=Math.abs(d-j),n=Math.abs(e-k),o=5;o>m&&o>n&&(b.mouse.x=j,b.mouse.y=k,a.click(j,k,l))}}),c.addEventListener("contextmenu",function(a){a.preventDefault()}),document.addEventListener("keydown",function(b){a.input.keys[b.keyCode]=!0,a.keydown(b.which,b)}),document.addEventListener("keyup",function(b){a.input.keys[b.keyCode]=!1,a.keyup(b.which,b)}),a.keypress&&document.addEventListener("keypress",function(b){a.keypress(b.which,b)})},b.exports=d},{"./keys":9}],9:[function(a,b){b.exports={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190}},{}],10:[function(a,b){b.exports=function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}},{}],11:[function(a,b){var c=function(){var a="(-webkit-min-device-pixel-ratio: 1.5),  (min--moz-device-pixel-ratio: 1.5),  (-o-min-device-pixel-ratio: 3/2),  (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(a).matches?!0:!1};b.exports=c},{}],12:[function(a,b){b.exports=function(){return window.performance||Date}()},{}],13:[function(a,b,c){{var d=c.get=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onload=function(){b(this.response)},c.send()};c.getJSON=function(a,b){d(a,function(a){b(JSON.parse(a))})}}c.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)}},{}],14:[function(a,b){var c=function(a,b){this.canvas=a,this.width=null,this.height=null,b.initializeCanvas&&(this.ctx=a.getContext("2d"))};c.prototype.include=function(a){for(var b in a)this[b]=a[b]},c.prototype.scaleCanvas=function(a){this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",this.canvas.width*=a,this.canvas.height*=a,this.ctx&&this.ctx.scale(a,a)},c.prototype.sprite=function(a,b,c,d,e,f,g){if(this.ctx){d=d||0,e=e||0,f=f||a.width,g=g||a.height,b=Math.floor(b),c=Math.floor(c);var h=f,i=g;a.src.match(/@2x.png$/)&&(h/=2,i/=2),this.ctx.drawImage(a,a.x+d,a.y+e,f,g,b,c,h,i)}},c.prototype.animation=function(a,b,c){this.ctx&&this.sprite(a.image,b,c,a.offsetX,a.offsetY,a.width,a.height)},b.exports=c},{}]},{},[1])(1)});