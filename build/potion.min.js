/**
 * potion - v0.7.3
 * Copyright (c) 2014, Jan Sedivy
 *
 * Compiled: 2014-12-02
 *
 * potion is licensed under the MIT License.
 */
!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Potion=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("./src/engine");b.exports={init:function(a,b){var d=new c(a,b);return d.game},Animation:a("./src/animation")}},{"./src/animation":25,"./src/engine":27}],2:[function(b,c,d){!function(){var b={},c=null,e=!0,f=!1;try{"undefined"!=typeof AudioContext?c=new AudioContext:"undefined"!=typeof webkitAudioContext?c=new webkitAudioContext:e=!1}catch(g){e=!1}if(!e)if("undefined"!=typeof Audio)try{new Audio}catch(g){f=!0}else f=!0;if(e){var h=void 0===c.createGain?c.createGainNode():c.createGain();h.gain.value=1,h.connect(c.destination)}var i=function(a){this._volume=1,this._muted=!1,this.usingWebAudio=e,this.ctx=c,this.noAudio=f,this._howls=[],this._codecs=a,this.iOSAutoEnable=!0};i.prototype={volume:function(a){var b=this;if(a=parseFloat(a),a>=0&&1>=a){b._volume=a,e&&(h.gain.value=a);for(var c in b._howls)if(b._howls.hasOwnProperty(c)&&b._howls[c]._webAudio===!1)for(var d=0;d<b._howls[c]._audioNode.length;d++)b._howls[c]._audioNode[d].volume=b._howls[c]._volume*b._volume;return b}return e?h.gain.value:b._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(a){var b=this;b._muted=a,e&&(h.gain.value=a?0:b._volume);for(var c in b._howls)if(b._howls.hasOwnProperty(c)&&b._howls[c]._webAudio===!1)for(var d=0;d<b._howls[c]._audioNode.length;d++)b._howls[c]._audioNode[d].muted=a},codecs:function(a){return this._codecs[a]},_enableiOSAudio:function(){var a=this;if(!c||!a._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){a._iOSEnabled=!1;var b=function(){var d=c.createBuffer(1,1,22050),e=c.createBufferSource();e.buffer=d,e.connect(c.destination),void 0===e.start?e.noteOn(0):e.start(0),setTimeout(function(){(e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE)&&(a._iOSEnabled=!0,a.iOSAutoEnable=!1,window.removeEventListener("touchstart",b,!1))},0)};return window.addEventListener("touchstart",b,!1),a}}};var j=null,k={};f||(j=new Audio,k={mp3:!!j.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!j.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!j.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!j.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!j.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(j.canPlayType("audio/x-m4a;")||j.canPlayType("audio/m4a;")||j.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(j.canPlayType("audio/x-mp4;")||j.canPlayType("audio/mp4;")||j.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!j.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var l=new i(k),m=function(a){var b=this;b._autoplay=a.autoplay||!1,b._buffer=a.buffer||!1,b._duration=a.duration||0,b._format=a.format||null,b._loop=a.loop||!1,b._loaded=!1,b._sprite=a.sprite||{},b._src=a.src||"",b._pos3d=a.pos3d||[0,0,-.5],b._volume=void 0!==a.volume?a.volume:1,b._urls=a.urls||[],b._rate=a.rate||1,b._model=a.model||null,b._onload=[a.onload||function(){}],b._onloaderror=[a.onloaderror||function(){}],b._onend=[a.onend||function(){}],b._onpause=[a.onpause||function(){}],b._onplay=[a.onplay||function(){}],b._onendTimer=[],b._webAudio=e&&!b._buffer,b._audioNode=[],b._webAudio&&b._setupAudioNode(),void 0!==c&&c&&l.iOSAutoEnable&&l._enableiOSAudio(),l._howls.push(b),b.load()};if(m.prototype={load:function(){var a=this,b=null;if(f)return void a.on("loaderror");for(var c=0;c<a._urls.length;c++){var d,e;if(a._format)d=a._format;else{if(e=a._urls[c],d=/^data:audio\/([^;,]+);/i.exec(e),d||(d=/\.([^.]+)$/.exec(e.split("?",1)[0])),!d)return void a.on("loaderror");d=d[1].toLowerCase()}if(k[d]){b=a._urls[c];break}}if(!b)return void a.on("loaderror");if(a._src=b,a._webAudio)n(a,b);else{var g=new Audio;g.addEventListener("error",function(){g.error&&4===g.error.code&&(i.noAudio=!0),a.on("loaderror",{type:g.error?g.error.code:0})},!1),a._audioNode.push(g),g.src=b,g._pos=0,g.preload="auto",g.volume=l._muted?0:a._volume*l.volume();var h=function(){a._duration=Math.ceil(10*g.duration)/10,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play(),g.removeEventListener("canplaythrough",h,!1)};g.addEventListener("canplaythrough",h,!1),g.load()}return a},urls:function(a){var b=this;return a?(b.stop(),b._urls="string"==typeof a?[a]:a,b._loaded=!1,b.load(),b):b._urls},play:function(a,b){var d=this;return"function"==typeof a&&(b=a),a&&"function"!=typeof a||(a="_default"),d._loaded?d._sprite[a]?(d._inactiveNode(function(e){e._sprite=a;var f=e._pos>0?e._pos:d._sprite[a][0]/1e3,g=0;d._webAudio?(g=d._sprite[a][1]/1e3-e._pos,e._pos>0&&(f=d._sprite[a][0]/1e3+f)):g=d._sprite[a][1]/1e3-(f-d._sprite[a][0]/1e3);var h,i=!(!d._loop&&!d._sprite[a][2]),j="string"==typeof b?b:Math.round(Date.now()*Math.random())+"";if(function(){var b={id:j,sprite:a,loop:i};h=setTimeout(function(){!d._webAudio&&i&&d.stop(b.id).play(a,b.id),d._webAudio&&!i&&(d._nodeById(b.id).paused=!0,d._nodeById(b.id)._pos=0,d._clearEndTimer(b.id)),d._webAudio||i||d.stop(b.id),d.on("end",j)},1e3*g),d._onendTimer.push({timer:h,id:b.id})}(),d._webAudio){var k=d._sprite[a][0]/1e3,m=d._sprite[a][1]/1e3;e.id=j,e.paused=!1,q(d,[i,k,m],j),d._playStart=c.currentTime,e.gain.value=d._volume,void 0===e.bufferSource.start?e.bufferSource.noteGrainOn(0,f,g):e.bufferSource.start(0,f,g)}else{if(4!==e.readyState&&(e.readyState||!navigator.isCocoonJS))return d._clearEndTimer(j),function(){var c=d,f=a,g=b,h=e,i=function(){c.play(f,g),h.removeEventListener("canplaythrough",i,!1)};h.addEventListener("canplaythrough",i,!1)}(),d;e.readyState=4,e.id=j,e.currentTime=f,e.muted=l._muted||e.muted,e.volume=d._volume*l.volume(),setTimeout(function(){e.play()},0)}return d.on("play"),"function"==typeof b&&b(j),d}),d):("function"==typeof b&&b(),d):(d.on("load",function(){d.play(a,b)}),d)},pause:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.pause(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=b.pos(null,a),b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0,void 0===c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else c.pause();return b.on("pause"),b},stop:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.stop(a)}),b;b._clearEndTimer(a);var c=a?b._nodeById(a):b._activeNode();if(c)if(c._pos=0,b._webAudio){if(!c.bufferSource||c.paused)return b;c.paused=!0,void 0===c.bufferSource.stop?c.bufferSource.noteOff(0):c.bufferSource.stop(0)}else isNaN(c.duration)||(c.pause(),c.currentTime=0);return b},mute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.mute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=0:c.muted=!0),b},unmute:function(a){var b=this;if(!b._loaded)return b.on("play",function(){b.unmute(a)}),b;var c=a?b._nodeById(a):b._activeNode();return c&&(b._webAudio?c.gain.value=b._volume:c.muted=!1),b},volume:function(a,b){var c=this;if(a=parseFloat(a),a>=0&&1>=a){if(c._volume=a,!c._loaded)return c.on("play",function(){c.volume(a,b)}),c;var d=b?c._nodeById(b):c._activeNode();return d&&(c._webAudio?d.gain.value=a:d.volume=a*l.volume()),c}return c._volume},loop:function(a){var b=this;return"boolean"==typeof a?(b._loop=a,b):b._loop},sprite:function(a){var b=this;return"object"==typeof a?(b._sprite=a,b):b._sprite},pos:function(a,b){var d=this;if(!d._loaded)return d.on("load",function(){d.pos(a)}),"number"==typeof a?d:d._pos||0;a=parseFloat(a);var e=b?d._nodeById(b):d._activeNode();if(e)return a>=0?(d.pause(b),e._pos=a,d.play(e._sprite,b),d):d._webAudio?e._pos+(c.currentTime-d._playStart):e.currentTime;if(a>=0)return d;for(var f=0;f<d._audioNode.length;f++)if(d._audioNode[f].paused&&4===d._audioNode[f].readyState)return d._webAudio?d._audioNode[f]._pos:d._audioNode[f].currentTime},pos3d:function(a,b,c,d){var e=this;if(b=void 0!==b&&b?b:0,c=void 0!==c&&c?c:-.5,!e._loaded)return e.on("play",function(){e.pos3d(a,b,c,d)}),e;if(!(a>=0||0>a))return e._pos3d;if(e._webAudio){var f=d?e._nodeById(d):e._activeNode();f&&(e._pos3d=[a,b,c],f.panner.setPosition(a,b,c),f.panner.panningModel=e._model||"HRTF")}return e},fade:function(a,b,c,d,e){var f=this,g=Math.abs(a-b),h=a>b?"down":"up",i=g/.01,j=c/i;if(!f._loaded)return f.on("load",function(){f.fade(a,b,c,d,e)}),f;f.volume(a,e);for(var k=1;i>=k;k++)!function(){var a=f._volume+("up"===h?.01:-.01)*k,c=Math.round(1e3*a)/1e3,g=b;setTimeout(function(){f.volume(c,e),c===g&&d&&d()},j*k)}()},fadeIn:function(a,b,c){return this.volume(0).play().fade(0,a,b,c)},fadeOut:function(a,b,c,d){var e=this;return e.fade(e._volume,a,b,function(){c&&c(),e.pause(d),e.on("end")},d)},_nodeById:function(a){for(var b=this,c=b._audioNode[0],d=0;d<b._audioNode.length;d++)if(b._audioNode[d].id===a){c=b._audioNode[d];break}return c},_activeNode:function(){for(var a=this,b=null,c=0;c<a._audioNode.length;c++)if(!a._audioNode[c].paused){b=a._audioNode[c];break}return a._drainPool(),b},_inactiveNode:function(a){for(var b=this,c=null,d=0;d<b._audioNode.length;d++)if(b._audioNode[d].paused&&4===b._audioNode[d].readyState){a(b._audioNode[d]),c=!0;break}if(b._drainPool(),!c){var e;if(b._webAudio)e=b._setupAudioNode(),a(e);else{b.load(),e=b._audioNode[b._audioNode.length-1];var f=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",g=function(){e.removeEventListener(f,g,!1),a(e)};e.addEventListener(f,g,!1)}}},_drainPool:function(){var a,b=this,c=0;for(a=0;a<b._audioNode.length;a++)b._audioNode[a].paused&&c++;for(a=b._audioNode.length-1;a>=0&&!(5>=c);a--)b._audioNode[a].paused&&(b._webAudio&&b._audioNode[a].disconnect(0),c--,b._audioNode.splice(a,1))},_clearEndTimer:function(a){for(var b=this,c=0,d=0;d<b._onendTimer.length;d++)if(b._onendTimer[d].id===a){c=d;break}var e=b._onendTimer[c];e&&(clearTimeout(e.timer),b._onendTimer.splice(c,1))},_setupAudioNode:function(){var a=this,b=a._audioNode,d=a._audioNode.length;return b[d]=void 0===c.createGain?c.createGainNode():c.createGain(),b[d].gain.value=a._volume,b[d].paused=!0,b[d]._pos=0,b[d].readyState=4,b[d].connect(h),b[d].panner=c.createPanner(),b[d].panner.panningModel=a._model||"equalpower",b[d].panner.setPosition(a._pos3d[0],a._pos3d[1],a._pos3d[2]),b[d].panner.connect(b[d]),b[d]},on:function(a,b){var c=this,d=c["_on"+a];if("function"==typeof b)d.push(b);else for(var e=0;e<d.length;e++)b?d[e].call(c,b):d[e].call(c);return c},off:function(a,b){var c=this,d=c["_on"+a],e=b?""+b:null;if(e){for(var f=0;f<d.length;f++)if(e===""+d[f]){d.splice(f,1);break}}else c["_on"+a]=[];return c},unload:function(){for(var a=this,c=a._audioNode,d=0;d<a._audioNode.length;d++)c[d].paused||(a.stop(c[d].id),a.on("end",c[d].id)),a._webAudio?c[d].disconnect(0):c[d].src="";for(d=0;d<a._onendTimer.length;d++)clearTimeout(a._onendTimer[d].timer);var e=l._howls.indexOf(a);null!==e&&e>=0&&l._howls.splice(e,1),delete b[a._src],a=null}},e)var n=function(a,c){if(c in b)return a._duration=b[c].duration,void p(a);if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=d.charCodeAt(f);o(e.buffer,a,c)}else{var g=new XMLHttpRequest;g.open("GET",c,!0),g.responseType="arraybuffer",g.onload=function(){o(g.response,a,c)},g.onerror=function(){a._webAudio&&(a._buffer=!0,a._webAudio=!1,a._audioNode=[],delete a._gainNode,delete b[c],a.load())};try{g.send()}catch(h){g.onerror()}}},o=function(a,d,e){c.decodeAudioData(a,function(a){a&&(b[e]=a,p(d,a))},function(){d.on("loaderror")})},p=function(a,b){a._duration=b?b.duration:a._duration,0===Object.getOwnPropertyNames(a._sprite).length&&(a._sprite={_default:[0,1e3*a._duration]}),a._loaded||(a._loaded=!0,a.on("load")),a._autoplay&&a.play()},q=function(a,d,e){var f=a._nodeById(e);f.bufferSource=c.createBufferSource(),f.bufferSource.buffer=b[a._src],f.bufferSource.connect(f.panner),f.bufferSource.loop=d[0],d[0]&&(f.bufferSource.loopStart=d[1],f.bufferSource.loopEnd=d[1]+d[2]),f.bufferSource.playbackRate.value=a._rate};"function"==typeof a&&a.amd&&a(function(){return{Howler:l,Howl:m}}),"undefined"!=typeof d&&(d.Howler=l,d.Howl=m),"undefined"!=typeof window&&(window.Howler=l,window.Howl=m)}()},{}],3:[function(){},{}],4:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],5:[function(a,b){var c=b.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},{}],6:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e=typeof a;if("base64"===b&&"string"===e)for(a=A(a);a.length%4!==0;)a+="=";var f;if("number"===e)f=D(a);else if("string"===e)f=d.byteLength(a,b);else{if("object"!==e)throw new Error("First argument needs to be a number, array or string.");f=D(a.length)}var g;d._useTypedArrays?g=B(new Uint8Array(f)):(g=this,g.length=f,g._isBuffer=!0);var h;if(d._useTypedArrays&&"function"==typeof Uint8Array&&a instanceof Uint8Array)g._set(a);else if(F(a))for(h=0;f>h;h++)g[h]=d.isBuffer(a)?a.readUInt8(h):a[h];else if("string"===e)g.write(a,0,b);else if("number"===e&&!d._useTypedArrays&&!c)for(h=0;f>h;h++)g[h]=0;return g}function e(a,b,c,e){c=Number(c)||0;var f=a.length-c;e?(e=Number(e),e>f&&(e=f)):e=f;var g=b.length;P(g%2===0,"Invalid hex string"),e>g/2&&(e=g/2);for(var h=0;e>h;h++){var i=parseInt(b.substr(2*h,2),16);P(!isNaN(i),"Invalid hex string"),a[c+h]=i}return d._charsWritten=2*h,h}function f(a,b,c,e){var f=d._charsWritten=K(H(b),a,c,e);return f}function g(a,b,c,e){var f=d._charsWritten=K(I(b),a,c,e);return f}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,e){var f=d._charsWritten=K(J(b),a,c,e);return f}function j(a,b,c){return Q.fromByteArray(0===b&&c===a.length?a:a.slice(b,c))}function k(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=L(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+L(e)}function l(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function m(a,b,c){return l(a,b,c)}function n(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=G(a[f]);return e}function o(a,b,c,d){d||(P("boolean"==typeof c,"missing or invalid endian"),P(void 0!==b&&null!==b,"missing offset"),P(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(f=a[b],e>b+1&&(f|=a[b+1]<<8)):(f=a[b]<<8,e>b+1&&(f|=a[b+1])),f}}function p(a,b,c,d){d||(P("boolean"==typeof c,"missing or invalid endian"),P(void 0!==b&&null!==b,"missing offset"),P(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(e>b+2&&(f=a[b+2]<<16),e>b+1&&(f|=a[b+1]<<8),f|=a[b],e>b+3&&(f+=a[b+3]<<24>>>0)):(e>b+1&&(f=a[b+1]<<16),e>b+2&&(f|=a[b+2]<<8),e>b+3&&(f|=a[b+3]),f+=a[b]<<24>>>0),f}}function q(a,b,c,d){d||(P("boolean"==typeof c,"missing or invalid endian"),P(void 0!==b&&null!==b,"missing offset"),P(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=o(a,b,c,!0),g=32768&f;return g?-1*(65535-f+1):f}}function r(a,b,c,d){d||(P("boolean"==typeof c,"missing or invalid endian"),P(void 0!==b&&null!==b,"missing offset"),P(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=p(a,b,c,!0),g=2147483648&f;return g?-1*(4294967295-f+1):f}}function s(a,b,c,d){return d||(P("boolean"==typeof c,"missing or invalid endian"),P(b+3<a.length,"Trying to read beyond buffer length")),R.read(a,b,c,23,4)}function t(a,b,c,d){return d||(P("boolean"==typeof c,"missing or invalid endian"),P(b+7<a.length,"Trying to read beyond buffer length")),R.read(a,b,c,52,8)}function u(a,b,c,d,e){e||(P(void 0!==b&&null!==b,"missing value"),P("boolean"==typeof d,"missing or invalid endian"),P(void 0!==c&&null!==c,"missing offset"),P(c+1<a.length,"trying to write beyond buffer length"),M(b,65535));var f=a.length;if(!(c>=f))for(var g=0,h=Math.min(f-c,2);h>g;g++)a[c+g]=(b&255<<8*(d?g:1-g))>>>8*(d?g:1-g)}function v(a,b,c,d,e){e||(P(void 0!==b&&null!==b,"missing value"),P("boolean"==typeof d,"missing or invalid endian"),P(void 0!==c&&null!==c,"missing offset"),P(c+3<a.length,"trying to write beyond buffer length"),M(b,4294967295));var f=a.length;if(!(c>=f))for(var g=0,h=Math.min(f-c,4);h>g;g++)a[c+g]=b>>>8*(d?g:3-g)&255}function w(a,b,c,d,e){e||(P(void 0!==b&&null!==b,"missing value"),P("boolean"==typeof d,"missing or invalid endian"),P(void 0!==c&&null!==c,"missing offset"),P(c+1<a.length,"Trying to write beyond buffer length"),N(b,32767,-32768));var f=a.length;c>=f||(b>=0?u(a,b,c,d,e):u(a,65535+b+1,c,d,e))}function x(a,b,c,d,e){e||(P(void 0!==b&&null!==b,"missing value"),P("boolean"==typeof d,"missing or invalid endian"),P(void 0!==c&&null!==c,"missing offset"),P(c+3<a.length,"Trying to write beyond buffer length"),N(b,2147483647,-2147483648));var f=a.length;c>=f||(b>=0?v(a,b,c,d,e):v(a,4294967295+b+1,c,d,e))}function y(a,b,c,d,e){e||(P(void 0!==b&&null!==b,"missing value"),P("boolean"==typeof d,"missing or invalid endian"),P(void 0!==c&&null!==c,"missing offset"),P(c+3<a.length,"Trying to write beyond buffer length"),O(b,3.4028234663852886e38,-3.4028234663852886e38));var f=a.length;c>=f||R.write(a,b,c,d,23,4)}function z(a,b,c,d,e){e||(P(void 0!==b&&null!==b,"missing value"),P("boolean"==typeof d,"missing or invalid endian"),P(void 0!==c&&null!==c,"missing offset"),P(c+7<a.length,"Trying to write beyond buffer length"),O(b,1.7976931348623157e308,-1.7976931348623157e308));var f=a.length;c>=f||R.write(a,b,c,d,52,8)}function A(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function B(a){return a._isBuffer=!0,a._get=a.get,a._set=a.set,a.get=S.get,a.set=S.set,a.write=S.write,a.toString=S.toString,a.toLocaleString=S.toString,a.toJSON=S.toJSON,a.copy=S.copy,a.slice=S.slice,a.readUInt8=S.readUInt8,a.readUInt16LE=S.readUInt16LE,a.readUInt16BE=S.readUInt16BE,a.readUInt32LE=S.readUInt32LE,a.readUInt32BE=S.readUInt32BE,a.readInt8=S.readInt8,a.readInt16LE=S.readInt16LE,a.readInt16BE=S.readInt16BE,a.readInt32LE=S.readInt32LE,a.readInt32BE=S.readInt32BE,a.readFloatLE=S.readFloatLE,a.readFloatBE=S.readFloatBE,a.readDoubleLE=S.readDoubleLE,a.readDoubleBE=S.readDoubleBE,a.writeUInt8=S.writeUInt8,a.writeUInt16LE=S.writeUInt16LE,a.writeUInt16BE=S.writeUInt16BE,a.writeUInt32LE=S.writeUInt32LE,a.writeUInt32BE=S.writeUInt32BE,a.writeInt8=S.writeInt8,a.writeInt16LE=S.writeInt16LE,a.writeInt16BE=S.writeInt16BE,a.writeInt32LE=S.writeInt32LE,a.writeInt32BE=S.writeInt32BE,a.writeFloatLE=S.writeFloatLE,a.writeFloatBE=S.writeFloatBE,a.writeDoubleLE=S.writeDoubleLE,a.writeDoubleBE=S.writeDoubleBE,a.fill=S.fill,a.inspect=S.inspect,a.toArrayBuffer=S.toArrayBuffer,a}function C(a,b,c){return"number"!=typeof a?c:(a=~~a,a>=b?b:a>=0?a:(a+=b,a>=0?a:0))}function D(a){return a=~~Math.ceil(+a),0>a?0:a}function E(a){return(Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)})(a)}function F(a){return E(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function G(a){return 16>a?"0"+a.toString(16):a.toString(16)}function H(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(127>=d)b.push(a.charCodeAt(c));else{var e=c;d>=55296&&57343>=d&&c++;for(var f=encodeURIComponent(a.slice(e,c+1)).substr(1).split("%"),g=0;g<f.length;g++)b.push(parseInt(f[g],16))}}return b}function I(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function J(a){return Q.toByteArray(a)}function K(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function L(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}function M(a,b){P("number"==typeof a,"cannot write a non-number as a number"),P(a>=0,"specified a negative value for writing an unsigned value"),P(b>=a,"value is larger than maximum value for type"),P(Math.floor(a)===a,"value has a fractional component")}function N(a,b,c){P("number"==typeof a,"cannot write a non-number as a number"),P(b>=a,"value larger than maximum allowed value"),P(a>=c,"value smaller than minimum allowed value"),P(Math.floor(a)===a,"value has a fractional component")}function O(a,b,c){P("number"==typeof a,"cannot write a non-number as a number"),P(b>=a,"value larger than maximum allowed value"),P(a>=c,"value smaller than minimum allowed value")}function P(a,b){if(!a)throw new Error(b||"Failed assertion")}var Q=a("base64-js"),R=a("ieee754");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192,d._useTypedArrays=function(){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer)return!1;try{var a=new Uint8Array(0);return a.foo=function(){return 42},42===a.foo()&&"function"==typeof a.subarray}catch(b){return!1}}(),d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.isBuffer=function(a){return!(null===a||void 0===a||!a._isBuffer)},d.byteLength=function(a,b){var c;switch(a+="",b||"utf8"){case"hex":c=a.length/2;break;case"utf8":case"utf-8":c=H(a).length;break;case"ascii":case"binary":case"raw":c=a.length;break;case"base64":c=J(a).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*a.length;break;default:throw new Error("Unknown encoding")}return c},d.concat=function(a,b){if(P(E(a),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===a.length)return new d(0);if(1===a.length)return a[0];var c;if("number"!=typeof b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var j=d;d=b,b=c,c=j}b=Number(b)||0;var k=this.length-b;switch(c?(c=Number(c),c>k&&(c=k)):c=k,d=String(d||"utf8").toLowerCase()){case"hex":return e(this,a,b,c);case"utf8":case"utf-8":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f(this,a,b,c);case"ascii":return g(this,a,b,c);case"binary":return h(this,a,b,c);case"base64":return i(this,a,b,c);default:throw new Error("Unknown encoding")}},d.prototype.toString=function(a,b,c){var d=this;if(a=String(a||"utf8").toLowerCase(),b=Number(b)||0,c=void 0!==c?Number(c):c=d.length,c===b)return"";switch(a){case"hex":return n(d,b,c);case"utf8":case"utf-8":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(d,b,c);case"ascii":return l(d,b,c);case"binary":return m(d,b,c);case"base64":return j(d,b,c);default:throw new Error("Unknown encoding")}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.copy=function(a,b,c,d){var e=this;if(c||(c=0),d||0===d||(d=this.length),b||(b=0),d!==c&&0!==a.length&&0!==e.length){P(d>=c,"sourceEnd < sourceStart"),P(b>=0&&b<a.length,"targetStart out of bounds"),P(c>=0&&c<e.length,"sourceStart out of bounds"),P(d>=0&&d<=e.length,"sourceEnd out of bounds"),d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);for(var f=0;d-c>f;f++)a[f+b]=this[f+c]}},d.prototype.slice=function(a,b){var c=this.length;if(a=C(a,c,0),b=C(b,c,c),d._useTypedArrays)return B(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.readUInt8=function(a,b){return b||(P(void 0!==a&&null!==a,"missing offset"),P(a<this.length,"Trying to read beyond buffer length")),a>=this.length?void 0:this[a]},d.prototype.readUInt16LE=function(a,b){return o(this,a,!0,b)},d.prototype.readUInt16BE=function(a,b){return o(this,a,!1,b)},d.prototype.readUInt32LE=function(a,b){return p(this,a,!0,b)},d.prototype.readUInt32BE=function(a,b){return p(this,a,!1,b)},d.prototype.readInt8=function(a,b){if(b||(P(void 0!==a&&null!==a,"missing offset"),P(a<this.length,"Trying to read beyond buffer length")),!(a>=this.length)){var c=128&this[a];return c?-1*(255-this[a]+1):this[a]}},d.prototype.readInt16LE=function(a,b){return q(this,a,!0,b)},d.prototype.readInt16BE=function(a,b){return q(this,a,!1,b)},d.prototype.readInt32LE=function(a,b){return r(this,a,!0,b)},d.prototype.readInt32BE=function(a,b){return r(this,a,!1,b)},d.prototype.readFloatLE=function(a,b){return s(this,a,!0,b)},d.prototype.readFloatBE=function(a,b){return s(this,a,!1,b)},d.prototype.readDoubleLE=function(a,b){return t(this,a,!0,b)},d.prototype.readDoubleBE=function(a,b){return t(this,a,!1,b)},d.prototype.writeUInt8=function(a,b,c){c||(P(void 0!==a&&null!==a,"missing value"),P(void 0!==b&&null!==b,"missing offset"),P(b<this.length,"trying to write beyond buffer length"),M(a,255)),b>=this.length||(this[b]=a)},d.prototype.writeUInt16LE=function(a,b,c){u(this,a,b,!0,c)},d.prototype.writeUInt16BE=function(a,b,c){u(this,a,b,!1,c)},d.prototype.writeUInt32LE=function(a,b,c){v(this,a,b,!0,c)},d.prototype.writeUInt32BE=function(a,b,c){v(this,a,b,!1,c)},d.prototype.writeInt8=function(a,b,c){c||(P(void 0!==a&&null!==a,"missing value"),P(void 0!==b&&null!==b,"missing offset"),P(b<this.length,"Trying to write beyond buffer length"),N(a,127,-128)),b>=this.length||(a>=0?this.writeUInt8(a,b,c):this.writeUInt8(255+a+1,b,c))},d.prototype.writeInt16LE=function(a,b,c){w(this,a,b,!0,c)},d.prototype.writeInt16BE=function(a,b,c){w(this,a,b,!1,c)},d.prototype.writeInt32LE=function(a,b,c){x(this,a,b,!0,c)},d.prototype.writeInt32BE=function(a,b,c){x(this,a,b,!1,c)},d.prototype.writeFloatLE=function(a,b,c){y(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){y(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){z(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){z(this,a,b,!1,c)},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),"string"==typeof a&&(a=a.charCodeAt(0)),P("number"==typeof a&&!isNaN(a),"value is not a number"),P(c>=b,"end < start"),c!==b&&0!==this.length){P(b>=0&&b<this.length,"start out of bounds"),P(c>=0&&c<=this.length,"end out of bounds");for(var d=b;c>d;d++)this[d]=a}},d.prototype.inspect=function(){for(var a=[],b=this.length,d=0;b>d;d++)if(a[d]=G(this[d]),d===c.INSPECT_MAX_BYTES){a[d+1]="...";break}return"<Buffer "+a.join(" ")+">"},d.prototype.toArrayBuffer=function(){if("function"==typeof Uint8Array){if(d._useTypedArrays)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var S=d.prototype},{"base64-js":7,ieee754:8}],7:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g?62:b===h?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],8:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?0/0:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||1/0===b?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],9:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];
return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5}],10:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],11:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,"/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5,inherits:4}],12:[function(a,b){var c=function(a,b){this.ctx=b,this.canvas=a,this.top=a.height,this.left=a.width,this.bottom=0,this.right=0,this.isDirty=!1};c.prototype.addRect=function(a,b,c,d){var e=a+c,f=b+d;this.top=b<this.top?b:this.top,this.left=a<this.left?a:this.left,this.bottom=f>this.bottom?f:this.bottom,this.right=e>this.right?e:this.right,this.isDirty=!0},c.prototype.clear=function(){this.isDirty&&(this.ctx.clearRect(this.left,this.top,this.right-this.left,this.bottom-this.top),this.left=this.canvas.width,this.top=this.canvas.height,this.right=0,this.bottom=0,this.isDirty=!1)},b.exports=c},{}],13:[function(a,b){var c=a("util"),d=a("source-map-support"),e=a("./dirty-manager"),f=function(a){return 9>=a?48+a:10===a?48:a>10&&36>=a?64+(a-10):null},g=[{name:"Show FPS",entry:"showFps","default":!0},{name:"Show Key Codes",entry:"showKeyCodes","default":!0},{name:"Show Time",entry:"showTime","default":!0}],h=function(a){this.video=a.video.createLayer({useRetina:!0,initializeCanvas:!0}),this.app=a,this.options=g,this._maxLogsCounts=10;for(var b=0;b<this.options.length;b++){var c=this.options[b];this._initOption(c)}this.disabled=!1,d.install(),this.fps=0,this.fpsCount=0,this.fpsElapsedTime=0,this.fpsUpdateInterval=.5,this._fontSize=0,this._dirtyManager=new e(this.video.canvas,this.video.ctx),this.logs=[],this.showDebug=!1,this.enableDebugKeys=!0,this.enableShortcuts=!1,this.enableShortcutsKey=220,this.lastKey=null,this._load(),this.keyShortcuts=[{key:123,entry:"showDebug",type:"toggle"}];var f=this;window.addEventListener("error",function(a){f.log(a.error.stack,"red")})};h.prototype._setFont=function(a,b){this._fontSize=a,this.video.ctx.font=a+"px "+b},h.prototype.resize=function(){this.video.setSize(this.app.width,this.app.height)},h.prototype.addConfig=function(a){this.options.push(a),this._initOption(a)},h.prototype._initOption=function(a){a.type=a.type||"toggle",a.default=null==a.default?!1:a.default,"toggle"===a.type&&(this[a.entry]=a.default)},h.prototype.log=function(a,b){b=b||"white",a="string"==typeof a?a:c.inspect(a);for(var d=a.replace(/\\'/g,"'").split("\n"),e=0;e<d.length;e++){var f=d[e];this.logs.length>=this._maxLogsCounts&&this.logs.shift(),this.logs.push({text:f,life:10,color:b})}},h.prototype.update=function(){},h.prototype.exitUpdate=function(a){if(!this.disabled&&this.showDebug){if(this._maxLogsCounts=Math.ceil((this.app.height+20)/20),this.fpsCount+=1,this.fpsElapsedTime+=a,this.fpsElapsedTime>this.fpsUpdateInterval){var b=this.fpsCount/this.fpsElapsedTime;this.showFps&&(this.fps=this.fps*(1-.8)+.8*b),this.fpsCount=0,this.fpsElapsedTime=0}for(var c=0,d=this.logs.length;d>c;c++){var e=this.logs[c];if(e&&(e.life-=a,e.life<=0)){var f=this.logs.indexOf(e);f>-1&&this.logs.splice(f,1)}}}},h.prototype.keydown=function(a){if(!this.disabled){this.lastKey=a;var b;if(this.enableDebugKeys){if(a===this.enableShortcutsKey)return this.enableShortcuts=!this.enableShortcuts,!0;if(this.enableShortcuts)for(b=0;b<this.options.length;b++){var c=this.options[b],d=b+1;this.app.input.isKeyDown("ctrl")&&(d-=36);var e=f(d);if(e&&a===e)return"toggle"===c.type?(this[c.entry]=!this[c.entry],this._save()):"call"===c.type&&c.entry(),!0}}for(b=0;b<this.keyShortcuts.length;b++){var g=this.keyShortcuts[b];if(g.key===a)return"toggle"===g.type?(this[g.entry]=!this[g.entry],this._save()):"call"===g.type&&this[g.entry](),!0}return!1}},h.prototype._save=function(){for(var a={showDebug:this.showDebug,options:{}},b=0;b<this.options.length;b++){var c=this.options[b],d=this[c.entry];a.options[c.entry]=d}window.localStorage.__potionDebug=JSON.stringify(a)},h.prototype._load=function(){if(window.localStorage&&window.localStorage.__potionDebug){var a=JSON.parse(window.localStorage.__potionDebug);this.showDebug=a.showDebug;for(var b in a.options)this[b]=a.options[b]}},h.prototype.render=function(){this.disabled||(this._dirtyManager.clear(),this.showDebug&&(this.video.ctx.save(),this._setFont(15,"sans-serif"),this._renderLogs(),this._renderData(),this._renderShortcuts(),this.video.ctx.restore()))},h.prototype._renderLogs=function(){this.video.ctx.textAlign="left",this.video.ctx.textBaseline="bottom";for(var a=0,b=this.logs.length;b>a;a++){var c=this.logs[a],d=-10+this.app.height+20*(a-this.logs.length+1);this._renderText(c.text,10,d,c.color)}},h.prototype.disable=function(){this.disabled=!0},h.prototype._renderData=function(){this.video.ctx.textAlign="right",this.video.ctx.textBaseline="top";var a=this.app.width-14,b=14;this.showFps&&this._renderText(Math.round(this.fps)+" fps",a,b),b+=20,this._setFont(20,"sans-serif"),this.showTime&&this.app.runtime&&null!=this.app.runtime.time&&this._renderText(this.app.runtime.time.toFixed(2)+" s",a,b),b+=30,this._setFont(15,"sans-serif"),this.showKeyCodes&&(this._renderText("key "+this.lastKey,a,b,this.app.input.isKeyDown(this.lastKey)?"#e9dc7c":"white"),this._renderText("btn "+this.app.input.mouse.button,a-60,b,this.app.input.mouse.isDown?"#e9dc7c":"white"))},h.prototype._renderShortcuts=function(){if(this.enableShortcuts){var a=28;this._setFont(20,"Helvetica Neue, sans-serif"),this.video.ctx.textAlign="left",this.video.ctx.textBaseline="top";for(var b=Math.floor((this.app.height-14)/a),c=0;c<this.options.length;c++){var d=this.options[c],e=14+320*Math.floor(c/b),g=14+c%b*a,h=c+1,i=f(h),j=this[d.entry],k=String.fromCharCode(i);i||(k="^+"+String.fromCharCode(f(h-36)));var l="["+k+"] "+d.name;"toggle"===d.type?l+=" ("+(j?"ON":"OFF")+")":"call"===d.type&&(l+=" (CALL)");var m="rgba(255, 255, 255, 1)",n="rgba(0, 0, 0, 1)";j||(m="rgba(255, 255, 255, .7)",n="rgba(0, 0, 0, .7)"),this._renderText(l,e,g,m,n)}}},h.prototype._renderText=function(a,b,c,d,e){d=d||"white",e=e||"black",this.video.ctx.fillStyle=d,this.video.ctx.lineJoin="round",this.video.ctx.strokeStyle=e,this.video.ctx.lineWidth=3,this.video.ctx.strokeText(a,b,c),this.video.ctx.fillText(a,b,c);var f=this.video.ctx.measureText(a).width,g=b-5,h=c,i=f+10,j=this._fontSize+10;"right"===this.video.ctx.textAlign&&(g=b-5-f),this._dirtyManager.addRect(g,h,i,j)},b.exports=h},{"./dirty-manager":12,"source-map-support":24,util:11}],14:[function(a,b,c){c.SourceMapGenerator=a("./source-map/source-map-generator").SourceMapGenerator,c.SourceMapConsumer=a("./source-map/source-map-consumer").SourceMapConsumer,c.SourceNode=a("./source-map/source-node").SourceNode},{"./source-map/source-map-consumer":19,"./source-map/source-map-generator":20,"./source-map/source-node":21}],15:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(){this._array=[],this._set={}}var d=a("./util");c.fromArray=function(a,b){for(var d=new c,e=0,f=a.length;f>e;e++)d.add(a[e],b);return d},c.prototype.add=function(a,b){var c=this.has(a),e=this._array.length;(!c||b)&&this._array.push(a),c||(this._set[d.toSetString(a)]=e)},c.prototype.has=function(a){return Object.prototype.hasOwnProperty.call(this._set,d.toSetString(a))},c.prototype.indexOf=function(a){if(this.has(a))return this._set[d.toSetString(a)];throw new Error('"'+a+'" is not in the set.')},c.prototype.at=function(a){if(a>=0&&a<this._array.length)return this._array[a];throw new Error("No element indexed by "+a)},c.prototype.toArray=function(){return this._array.slice()},b.ArraySet=c})},{"./util":22,amdefine:23}],16:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(a){return 0>a?(-a<<1)+1:(a<<1)+0}function d(a){var b=1===(1&a),c=a>>1;return b?-c:c}var e=a("./base64"),f=5,g=1<<f,h=g-1,i=g;b.encode=function(a){var b,d="",g=c(a);do b=g&h,g>>>=f,g>0&&(b|=i),d+=e.encode(b);while(g>0);return d},b.decode=function(a){var b,c,g=0,j=a.length,k=0,l=0;do{if(g>=j)throw new Error("Expected more digits in base 64 VLQ value.");c=e.decode(a.charAt(g++)),b=!!(c&i),c&=h,k+=c<<l,l+=f}while(b);return{value:d(k),rest:a.slice(g)}}})},{"./base64":17,amdefine:23}],17:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){var c={},d={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(function(a,b){c[a]=b,d[b]=a}),b.encode=function(a){if(a in d)return d[a];throw new TypeError("Must be between 0 and 63: "+a)},b.decode=function(a){if(a in c)return c[a];throw new TypeError("Not a valid base 64 digit: "+a)}})},{amdefine:23}],18:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(a,b,d,e,f){var g=Math.floor((b-a)/2)+a,h=f(d,e[g],!0);return 0===h?e[g]:h>0?b-g>1?c(g,b,d,e,f):e[g]:g-a>1?c(a,g,d,e,f):0>a?null:e[a]}b.search=function(a,b,d){return b.length>0?c(-1,b.length,a,b,d):null}})},{amdefine:23}],19:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(a){var b=a;"string"==typeof a&&(b=JSON.parse(a.replace(/^\)\]\}'/,"")));var c=d.getArg(b,"version"),e=d.getArg(b,"sources"),g=d.getArg(b,"names",[]),h=d.getArg(b,"sourceRoot",null),i=d.getArg(b,"sourcesContent",null),j=d.getArg(b,"mappings"),k=d.getArg(b,"file",null);if(c!=this._version)throw new Error("Unsupported version: "+c);this._names=f.fromArray(g,!0),this._sources=f.fromArray(e,!0),this.sourceRoot=h,this.sourcesContent=i,this._mappings=j,this.file=k}var d=a("./util"),e=a("./binary-search"),f=a("./array-set").ArraySet,g=a("./base64-vlq");c.fromSourceMap=function(a){var b=Object.create(c.prototype);return b._names=f.fromArray(a._names.toArray(),!0),b._sources=f.fromArray(a._sources.toArray(),!0),b.sourceRoot=a._sourceRoot,b.sourcesContent=a._generateSourcesContent(b._sources.toArray(),b.sourceRoot),b.file=a._file,b.__generatedMappings=a._mappings.slice().sort(d.compareByGeneratedPositions),b.__originalMappings=a._mappings.slice().sort(d.compareByOriginalPositions),b},c.prototype._version=3,Object.defineProperty(c.prototype,"sources",{get:function(){return this._sources.toArray().map(function(a){return this.sourceRoot?d.join(this.sourceRoot,a):a},this)}}),c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}}),c.prototype._parseMappings=function(a){for(var b,c,e=1,f=0,h=0,i=0,j=0,k=0,l=/^[,;]/,m=a;m.length>0;)if(";"===m.charAt(0))e++,m=m.slice(1),f=0;else if(","===m.charAt(0))m=m.slice(1);else{if(b={},b.generatedLine=e,c=g.decode(m),b.generatedColumn=f+c.value,f=b.generatedColumn,m=c.rest,m.length>0&&!l.test(m.charAt(0))){if(c=g.decode(m),b.source=this._sources.at(j+c.value),j+=c.value,m=c.rest,0===m.length||l.test(m.charAt(0)))throw new Error("Found a source, but no line and column");if(c=g.decode(m),b.originalLine=h+c.value,h=b.originalLine,b.originalLine+=1,m=c.rest,0===m.length||l.test(m.charAt(0)))throw new Error("Found a source and line, but no column");c=g.decode(m),b.originalColumn=i+c.value,i=b.originalColumn,m=c.rest,m.length>0&&!l.test(m.charAt(0))&&(c=g.decode(m),b.name=this._names.at(k+c.value),k+=c.value,m=c.rest)}this.__generatedMappings.push(b),"number"==typeof b.originalLine&&this.__originalMappings.push(b)}this.__generatedMappings.sort(d.compareByGeneratedPositions),this.__originalMappings.sort(d.compareByOriginalPositions)},c.prototype._findMapping=function(a,b,c,d,f){if(a[c]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+a[c]);if(a[d]<0)throw new TypeError("Column must be greater than or equal to 0, got "+a[d]);return e.search(a,b,f)},c.prototype.originalPositionFor=function(a){var b={generatedLine:d.getArg(a,"line"),generatedColumn:d.getArg(a,"column")},c=this._findMapping(b,this._generatedMappings,"generatedLine","generatedColumn",d.compareByGeneratedPositions);if(c){var e=d.getArg(c,"source",null);return e&&this.sourceRoot&&(e=d.join(this.sourceRoot,e)),{source:e,line:d.getArg(c,"originalLine",null),column:d.getArg(c,"originalColumn",null),name:d.getArg(c,"name",null)}}return{source:null,line:null,column:null,name:null}},c.prototype.sourceContentFor=function(a){if(!this.sourcesContent)return null;if(this.sourceRoot&&(a=d.relative(this.sourceRoot,a)),this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];var b;if(this.sourceRoot&&(b=d.urlParse(this.sourceRoot))){var c=a.replace(/^file:\/\//,"");if("file"==b.scheme&&this._sources.has(c))return this.sourcesContent[this._sources.indexOf(c)];if((!b.path||"/"==b.path)&&this._sources.has("/"+a))return this.sourcesContent[this._sources.indexOf("/"+a)]}throw new Error('"'+a+'" is not in the SourceMap.')},c.prototype.generatedPositionFor=function(a){var b={source:d.getArg(a,"source"),originalLine:d.getArg(a,"line"),originalColumn:d.getArg(a,"column")};this.sourceRoot&&(b.source=d.relative(this.sourceRoot,b.source));var c=this._findMapping(b,this._originalMappings,"originalLine","originalColumn",d.compareByOriginalPositions);return c?{line:d.getArg(c,"generatedLine",null),column:d.getArg(c,"generatedColumn",null)}:{line:null,column:null}},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.prototype.eachMapping=function(a,b,e){var f,g=b||null,h=e||c.GENERATED_ORDER;switch(h){case c.GENERATED_ORDER:f=this._generatedMappings;break;case c.ORIGINAL_ORDER:f=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var i=this.sourceRoot;f.map(function(a){var b=a.source;return b&&i&&(b=d.join(i,b)),{source:b,generatedLine:a.generatedLine,generatedColumn:a.generatedColumn,originalLine:a.originalLine,originalColumn:a.originalColumn,name:a.name}}).forEach(a,g)},b.SourceMapConsumer=c})},{"./array-set":15,"./base64-vlq":16,"./binary-search":18,"./util":22,amdefine:23}],20:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(a){this._file=e.getArg(a,"file"),this._sourceRoot=e.getArg(a,"sourceRoot",null),this._sources=new f,this._names=new f,this._mappings=[],this._sourcesContents=null}var d=a("./base64-vlq"),e=a("./util"),f=a("./array-set").ArraySet;c.prototype._version=3,c.fromSourceMap=function(a){var b=a.sourceRoot,d=new c({file:a.file,sourceRoot:b});return a.eachMapping(function(a){var c={generated:{line:a.generatedLine,column:a.generatedColumn}};a.source&&(c.source=a.source,b&&(c.source=e.relative(b,c.source)),c.original={line:a.originalLine,column:a.originalColumn},a.name&&(c.name=a.name)),d.addMapping(c)}),a.sources.forEach(function(b){var c=a.sourceContentFor(b);c&&d.setSourceContent(b,c)}),d},c.prototype.addMapping=function(a){var b=e.getArg(a,"generated"),c=e.getArg(a,"original",null),d=e.getArg(a,"source",null),f=e.getArg(a,"name",null);this._validateMapping(b,c,d,f),d&&!this._sources.has(d)&&this._sources.add(d),f&&!this._names.has(f)&&this._names.add(f),this._mappings.push({generatedLine:b.line,generatedColumn:b.column,originalLine:null!=c&&c.line,originalColumn:null!=c&&c.column,source:d,name:f})},c.prototype.setSourceContent=function(a,b){var c=a;this._sourceRoot&&(c=e.relative(this._sourceRoot,c)),null!==b?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[e.toSetString(c)]=b):(delete this._sourcesContents[e.toSetString(c)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},c.prototype.applySourceMap=function(a,b){b||(b=a.file);var c=this._sourceRoot;c&&(b=e.relative(c,b));var d=new f,g=new f;this._mappings.forEach(function(f){if(f.source===b&&f.originalLine){var h=a.originalPositionFor({line:f.originalLine,column:f.originalColumn});null!==h.source&&(f.source=c?e.relative(c,h.source):h.source,f.originalLine=h.line,f.originalColumn=h.column,null!==h.name&&null!==f.name&&(f.name=h.name))}var i=f.source;i&&!d.has(i)&&d.add(i);var j=f.name;j&&!g.has(j)&&g.add(j)},this),this._sources=d,this._names=g,a.sources.forEach(function(b){var d=a.sourceContentFor(b);d&&(c&&(b=e.relative(c,b)),this.setSourceContent(b,d))},this)},c.prototype._validateMapping=function(a,b,c,d){if(!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0&&!b&&!c&&!d||a&&"line"in a&&"column"in a&&b&&"line"in b&&"column"in b&&a.line>0&&a.column>=0&&b.line>0&&b.column>=0&&c))throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:c,original:b,name:d}))},c.prototype._serializeMappings=function(){var a,b=0,c=1,f=0,g=0,h=0,i=0,j="";this._mappings.sort(e.compareByGeneratedPositions);for(var k=0,l=this._mappings.length;l>k;k++){if(a=this._mappings[k],a.generatedLine!==c)for(b=0;a.generatedLine!==c;)j+=";",c++;else if(k>0){if(!e.compareByGeneratedPositions(a,this._mappings[k-1]))continue;j+=","}j+=d.encode(a.generatedColumn-b),b=a.generatedColumn,a.source&&(j+=d.encode(this._sources.indexOf(a.source)-i),i=this._sources.indexOf(a.source),j+=d.encode(a.originalLine-1-g),g=a.originalLine-1,j+=d.encode(a.originalColumn-f),f=a.originalColumn,a.name&&(j+=d.encode(this._names.indexOf(a.name)-h),h=this._names.indexOf(a.name)))}return j},c.prototype._generateSourcesContent=function(a,b){return a.map(function(a){if(!this._sourcesContents)return null;b&&(a=e.relative(b,a));var c=e.toSetString(a);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)},c.prototype.toJSON=function(){var a={version:this._version,file:this._file,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._sourceRoot&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a},c.prototype.toString=function(){return JSON.stringify(this)},b.SourceMapGenerator=c})},{"./array-set":15,"./base64-vlq":16,"./util":22,amdefine:23}],21:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(a,b,c,d,e){this.children=[],this.sourceContents={},this.line=void 0===a?null:a,this.column=void 0===b?null:b,this.source=void 0===c?null:c,this.name=void 0===e?null:e,null!=d&&this.add(d)}var d=a("./source-map-generator").SourceMapGenerator,e=a("./util");c.fromStringWithSourceMap=function(a,b){function d(a,b){e.add(null===a||void 0===a.source?b:new c(a.originalLine,a.originalColumn,a.source,b,a.name))}var e=new c,f=a.split("\n"),g=1,h=0,i=null;return b.eachMapping(function(a){if(null===i){for(;g<a.generatedLine;)e.add(f.shift()+"\n"),g++;if(h<a.generatedColumn){var b=f[0];e.add(b.substr(0,a.generatedColumn)),f[0]=b.substr(a.generatedColumn),h=a.generatedColumn}}else if(g<a.generatedLine){var c="";do c+=f.shift()+"\n",g++,h=0;while(g<a.generatedLine);if(h<a.generatedColumn){var b=f[0];c+=b.substr(0,a.generatedColumn),f[0]=b.substr(a.generatedColumn),h=a.generatedColumn}d(i,c)}else{var b=f[0],c=b.substr(0,a.generatedColumn-h);f[0]=b.substr(a.generatedColumn-h),h=a.generatedColumn,d(i,c)}i=a},this),d(i,f.join("\n")),b.sources.forEach(function(a){var c=b.sourceContentFor(a);c&&e.setSourceContent(a,c)}),e},c.prototype.add=function(a){if(Array.isArray(a))a.forEach(function(a){this.add(a)},this);else{if(!(a instanceof c||"string"==typeof a))throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);a&&this.children.push(a)}return this},c.prototype.prepend=function(a){if(Array.isArray(a))for(var b=a.length-1;b>=0;b--)this.prepend(a[b]);else{if(!(a instanceof c||"string"==typeof a))throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);this.children.unshift(a)}return this},c.prototype.walk=function(a){for(var b,d=0,e=this.children.length;e>d;d++)b=this.children[d],b instanceof c?b.walk(a):""!==b&&a(b,{source:this.source,line:this.line,column:this.column,name:this.name})},c.prototype.join=function(a){var b,c,d=this.children.length;if(d>0){for(b=[],c=0;d-1>c;c++)b.push(this.children[c]),b.push(a);b.push(this.children[c]),this.children=b}return this},c.prototype.replaceRight=function(a,b){var d=this.children[this.children.length-1];return d instanceof c?d.replaceRight(a,b):"string"==typeof d?this.children[this.children.length-1]=d.replace(a,b):this.children.push("".replace(a,b)),this},c.prototype.setSourceContent=function(a,b){this.sourceContents[e.toSetString(a)]=b},c.prototype.walkSourceContents=function(a){for(var b=0,d=this.children.length;d>b;b++)this.children[b]instanceof c&&this.children[b].walkSourceContents(a);for(var f=Object.keys(this.sourceContents),b=0,d=f.length;d>b;b++)a(e.fromSetString(f[b]),this.sourceContents[f[b]])},c.prototype.toString=function(){var a="";return this.walk(function(b){a+=b}),a},c.prototype.toStringWithSourceMap=function(a){var b={code:"",line:1,column:0},c=new d(a),e=!1,f=null,g=null,h=null,i=null;return this.walk(function(a,d){b.code+=a,null!==d.source&&null!==d.line&&null!==d.column?((f!==d.source||g!==d.line||h!==d.column||i!==d.name)&&c.addMapping({source:d.source,original:{line:d.line,column:d.column},generated:{line:b.line,column:b.column},name:d.name}),f=d.source,g=d.line,h=d.column,i=d.name,e=!0):e&&(c.addMapping({generated:{line:b.line,column:b.column}}),f=null,e=!1),a.split("").forEach(function(a){"\n"===a?(b.line++,b.column=0):b.column++})}),this.walkSourceContents(function(a,b){c.setSourceContent(a,b)}),{code:b.code,map:c}},b.SourceNode=c})},{"./source-map-generator":20,"./util":22,amdefine:23}],22:[function(a,b){if("function"!=typeof c)var c=a("amdefine")(b,a);c(function(a,b){function c(a,b,c){if(b in a)return a[b];if(3===arguments.length)return c;throw new Error('"'+b+'" is a required argument.')}function d(a){var b=a.match(m);return b?{scheme:b[1],auth:b[3],host:b[4],port:b[6],path:b[7]}:null}function e(a){var b=a.scheme+"://";return a.auth&&(b+=a.auth+"@"),a.host&&(b+=a.host),a.port&&(b+=":"+a.port),a.path&&(b+=a.path),b}function f(a,b){var c;return b.match(m)||b.match(n)?b:"/"===b.charAt(0)&&(c=d(a))?(c.path=b,e(c)):a.replace(/\/$/,"")+"/"+b}function g(a){return"$"+a}function h(a){return a.substr(1)}function i(a,b){a=a.replace(/\/$/,"");var c=d(a);return"/"==b.charAt(0)&&c&&"/"==c.path?b.slice(1):0===b.indexOf(a+"/")?b.substr(a.length+1):b}function j(a,b){var c=a||"",d=b||"";return(c>d)-(d>c)}function k(a,b,c){var d;return(d=j(a.source,b.source))?d:(d=a.originalLine-b.originalLine)?d:(d=a.originalColumn-b.originalColumn,d||c?d:(d=j(a.name,b.name))?d:(d=a.generatedLine-b.generatedLine,d?d:a.generatedColumn-b.generatedColumn))}function l(a,b,c){var d;return(d=a.generatedLine-b.generatedLine)?d:(d=a.generatedColumn-b.generatedColumn,d||c?d:(d=j(a.source,b.source))?d:(d=a.originalLine-b.originalLine)?d:(d=a.originalColumn-b.originalColumn,d?d:j(a.name,b.name)))}b.getArg=c;var m=/([\w+\-.]+):\/\/((\w+:\w+)@)?([\w.]+)?(:(\d+))?(\S+)?/,n=/^data:.+\,.+/;b.urlParse=d,b.urlGenerate=e,b.join=f,b.toSetString=g,b.fromSetString=h,b.relative=i,b.compareByOriginalPositions=k,b.compareByGeneratedPositions=l})},{amdefine:23}],23:[function(a,b){(function(c,d){"use strict";function e(b,e){function f(a){var b,c;for(b=0;a[b];b+=1)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(1===b&&(".."===a[2]||".."===a[0]))break;b>0&&(a.splice(b-1,2),b-=2)}}function g(a,b){var c;return a&&"."===a.charAt(0)&&b&&(c=b.split("/"),c=c.slice(0,c.length-1),c=c.concat(a.split("/")),f(c),a=c.join("/")),a}function h(a){return function(b){return g(b,a)}}function i(a){function b(b){o[a]=b}return b.fromText=function(){throw new Error("amdefine does not implement load.fromText")},b}function j(a,c,f){var g,h,i,j;if(a)h=o[a]={},i={id:a,uri:d,exports:h},g=l(e,h,i,a);else{if(p)throw new Error("amdefine with no module ID cannot be called more than once per file.");p=!0,h=b.exports,i=b,g=l(e,h,i,b.id)}c&&(c=c.map(function(a){return g(a)})),j="function"==typeof f?f.apply(i.exports,c):f,void 0!==j&&(i.exports=j,a&&(o[a]=i.exports))}function k(a,b,c){Array.isArray(a)?(c=b,b=a,a=void 0):"string"!=typeof a&&(c=a,a=b=void 0),b&&!Array.isArray(b)&&(c=b,b=void 0),b||(b=["require","exports","module"]),a?n[a]=[a,b,c]:j(a,b,c)}var l,m,n={},o={},p=!1,q=a("path");return l=function(a,b,d,e){function f(f,g){return"string"==typeof f?m(a,b,d,f,e):(f=f.map(function(c){return m(a,b,d,c,e)}),void c.nextTick(function(){g.apply(null,f)}))}return f.toUrl=function(a){return 0===a.indexOf(".")?g(a,q.dirname(d.filename)):a},f},e=e||function(){return b.require.apply(b,arguments)},m=function(a,b,c,d,e){var f,k,p=d.indexOf("!"),q=d;if(-1===p){if(d=g(d,e),"require"===d)return l(a,b,c,e);if("exports"===d)return b;if("module"===d)return c;if(o.hasOwnProperty(d))return o[d];if(n[d])return j.apply(null,n[d]),o[d];if(a)return a(q);throw new Error("No module with ID: "+d)}return f=d.substring(0,p),d=d.substring(p+1,d.length),k=m(a,b,c,f,e),d=k.normalize?k.normalize(d,h(e)):g(d,e),o[d]?o[d]:(k.load(d,l(a,b,c,e),i(d),{}),o[d])},k.require=function(a){return o[a]?o[a]:n[a]?(j.apply(null,n[a]),o[a]):void 0
},k.amd={},k}b.exports=e}).call(this,a("/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"/node_modules/potion-debugger/node_modules/source-map-support/node_modules/source-map/node_modules/amdefine/amdefine.js")},{"/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5,path:9}],24:[function(a,b,c){(function(b,d){function e(){return"undefined"!=typeof window}function f(a){if(a in u)return u[a];try{if(e()){var b=new XMLHttpRequest;b.open("GET",a,!1),b.send(null);var c=4===b.readyState?b.responseText:null}else var c=r.readFileSync(a,"utf8")}catch(d){var c=null}return u[a]=c}function g(a,b){if(!a)return b;var c=q.dirname(a),d=/^\w+:\/\/[^\/]*/.exec(c),e=d?d[0]:"";return e+q.resolve(c.slice(e.length),b)}function h(a){var b;if(e()){var c=new XMLHttpRequest;c.open("GET",a,!1),c.send(null),b=4===c.readyState?c.responseText:null;var d=c.getResponseHeader("SourceMap")||c.getResponseHeader("X-SourceMap");if(d)return d}b=f(a);var g=/\/\/[#@]\s*sourceMappingURL=(.*)\s*$/m.exec(b);return g?g[1]:null}function i(a){var b=h(a);if(!b)return null;var c,e="data:application/json;base64,";return b.slice(0,e.length).toLowerCase()==e?(c=new d(b.slice(e.length),"base64").toString(),b=null):(b=g(a,b),c=f(b,"utf8")),c?{url:b,map:c}:null}function j(a){var b=v[a.source];if(!b){var c=i(a.source);c&&(b=v[a.source]={url:c.url,map:new p(c.map)},b.map.sourcesContent&&b.map.sources.forEach(function(a,c){var d=b.map.sourcesContent[c];if(d){var e=g(b.url,a);u[e]=d}}))}if(b){var d=b.map.originalPositionFor(a);if(null!==d.source)return d.source=g(b.url,d.source),d}return a}function k(a){var b=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(a);if(b){var c=j({source:b[2],line:b[3],column:b[4]-1});return"eval at "+b[1]+" ("+c.source+":"+c.line+":"+(c.column+1)+")"}return b=/^eval at ([^(]+) \((.+)\)$/.exec(a),b?"eval at "+b[1]+" ("+k(b[2])+")":a}function l(a){var b=a.getFileName()||a.getScriptNameOrSourceURL();if(b){var c=j({source:b,line:a.getLineNumber(),column:a.getColumnNumber()-1});return{__proto__:a,getFileName:function(){return c.source},getLineNumber:function(){return c.line},getColumnNumber:function(){return c.column+1},getScriptNameOrSourceURL:function(){return c.source}}}var d=a.isEval()&&a.getEvalOrigin();return d?(d=k(d),{__proto__:a,getEvalOrigin:function(){return d}}):a}function m(a,b){return t&&(u={},v={}),a+b.map(function(a){return"\n    at "+l(a)}).join("")}function n(a){var b=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(a.stack);if(b){var c=b[1],d=+b[2],e=+b[3],f=u[c];if(!f&&r.existsSync(c)&&(f=r.readFileSync(c,"utf8")),f){var g=f.split(/(?:\r\n|\r|\n)/)[d-1];if(g)return"\n"+c+":"+d+"\n"+g+"\n"+new Array(e).join(" ")+"^"}}return null}function o(a){if(a&&a.stack){var c=n(a);null!==c&&console.log(c),console.log(a.stack)}else console.log("Uncaught exception:",a);b.exit(1)}var p=a("source-map").SourceMapConsumer,q=a("path"),r=a("fs"),s=!1,t=!1,u={},v={};c.wrapCallSite=l,c.getErrorSource=n,c.mapSourcePosition=j,c.retrieveSourceMap=i,c.install=function(a){if(!s){s=!0,Error.prepareStackTrace=m,a=a||{};var c="handleUncaughtExceptions"in a?a.handleUncaughtExceptions:!0;t="emptyCacheBetweenOperations"in a?a.emptyCacheBetweenOperations:!1,a.retrieveFile&&(f=a.retrieveFile),a.retrieveSourceMap&&(i=a.retrieveSourceMap),c&&!e()&&b.on("uncaughtException",o)}}}).call(this,a("/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),a("buffer").Buffer)},{"/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5,buffer:6,fs:3,path:9,"source-map":14}],25:[function(a,b){var c=function(a,b,c,d){this.image=a,this.width=b,this.height=c,this.columns=d,this.state=0,this.indexX=0,this.indexY=0,this.offsetX=0,this.offsetY=0};c.prototype.setIndexes=function(a,b){this.setIndexX(a),this.setIndexY(b)},c.prototype.setIndexX=function(a){this.indexX=a,this.offsetX=this.width*this.indexX},c.prototype.setIndexY=function(a){this.indexY=a,this.offsetY=this.height*this.indexY},c.prototype.setState=function(a){this.state=a;var b=this.state,c=0;this.columns&&(b=this.state%this.columns,c=Math.floor(this.state/this.columns)),this.setIndexX(b),this.setIndexY(c)},b.exports=c},{}],26:[function(a,b){(function(c){var d=a("./utils");a("../lib/howler.min.js");var e=function(){this.isLoading=!1,this.itemsCount=0,this.loadedItemsCount=0,this.progress=0,this._xhr=new XMLHttpRequest,this._thingsToLoad=0,this._data={},this.callback=null,this._toLoad=[]};e.prototype.onload=function(a){this.callback=a,0===this._thingsToLoad?(this.isLoading=!1,c.nextTick(function(){a()})):this._nextFile()},e.prototype.get=function(a){return this._data[a]},e.prototype.set=function(a,b){this._data[a]=b},e.prototype.load=function(a,b,c){this.isLoading=!0,this.itemsCount+=1,this._thingsToLoad+=1,this._toLoad.push({type:a,url:b,callback:c})},e.prototype._finishedOneFile=function(){if(this._nextFile(),this._thingsToLoad-=1,this.loadedItemsCount+=1,0===this._thingsToLoad){var a=this;setTimeout(function(){a.callback(),a.isLoading=!1},0)}},e.prototype._error=function(a,b){console.warn('Error loading "'+a+'" asset with url '+b),this._nextFile()},e.prototype._save=function(a,b,c){this.set(a,b),c&&c(b),this._finishedOneFile()},e.prototype._handleCustomLoading=function(a){var b=this,c=function(a,c){b._save(a,c)};a(c)},e.prototype._nextFile=function(){var a=this._toLoad.shift();if(a){var b=a.type,c=a.url,e=a.callback,f=this;if(d.isFunction(b))return void this._handleCustomLoading(b);b=b.toLowerCase();var g=this._xhr;switch(g.onprogress=function(a){var b=a.loaded/a.total;f.progress=f.loadedItemsCount/f.itemsCount+b/f.itemsCount},b){case"json":g.open("GET",c,!0),g.responseType="text",g.onload=function(){var a=JSON.parse(this.response);f._save(c,a,e)},g.onerror=function(){f._error(b,c)},g.send();break;case"mp3":case"music":case"sound":var h=new Howl({urls:[c],onload:function(){f._save(c,h,e)},onloaderror:function(){f._error(b,c)}});break;case"image":case"texture":case"sprite":var i=new Image;i.onload=function(){f._save(c,i,e)},i.onerror=function(){f._error(b,c)},i.src=c;break;default:g.open("GET",c,!0),g.responseType="text",g.onload=function(){var a=this.response;f._save(c,a,e)},g.onerror=function(){f._error(b,c)},g.send()}}},b.exports=e}).call(this,a("/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"../lib/howler.min.js":2,"./utils":35,"/Users/sedivy/Dropbox/dev/potion/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":5}],27:[function(a,b){a("./raf-polyfill")();var c=a("./game"),d=a("./input"),e=a("./time"),f=a("potion-debugger"),g=a("./state-manager"),h=function(a,b){var c=this._subclassGame(a,b);a.style.position="relative";var g=document.createElement("canvas");g.width=a.clientWidth,g.height=a.clientHeight,g.style.display="block",a.appendChild(g),this.game=new c(g),this.game.debug=new f(this.game),this._setDefaultStates(),this.game.config.addInputEvents&&(this.game.input=new d(this.game,a)),this.tickFunc=function(a){return function(){a.tick()}}(this),this.preloaderTickFunc=function(a){return function(){a._preloaderTick()}}(this),this.strayTime=0,this._time=e.now(),this.game.assets.onload(function(){this.start(),window.cancelAnimationFrame(this.preloaderId),window.requestAnimationFrame(this.tickFunc)}.bind(this)),this.game.assets.isLoading&&(this.preloaderId=window.requestAnimationFrame(this.preloaderTickFunc))};h.prototype._setDefaultStates=function(){var a=new g;a.add("app",this.game),a.add("debug",this.game.debug),a.protect("app"),a.protect("debug"),this.game.states=a},h.prototype._subclassGame=function(a,b){var d=function(a){c.call(this,a)};d.prototype=Object.create(c.prototype);for(var e in b)d.prototype[e]=b[e];return d},h.prototype.addEvents=function(){var a=this,b=a.game;window.addEventListener("resize",function(){b.video.setSize(a.game.canvas.parentElement.clientWidth,a.game.canvas.parentElement.clientHeight),b.width=b.video.width,b.height=b.video.height}),window.addEventListener("blur",function(){a.game.input.resetKeys(),a.game.blur()}),window.addEventListener("focus",function(){a.game.input.resetKeys(),a.game.focus()})},h.prototype.start=function(){this.game.config.addInputEvents&&this.addEvents()},h.prototype.tick=function(){window.requestAnimationFrame(this.tickFunc);var a=e.now(),b=(a-this._time)/1e3;this._time=a,this.update(b),this.game.states.exitUpdate(b),this.render()},h.prototype._preloaderTick=function(){this.preloaderId=window.requestAnimationFrame(this.preloaderTickFunc);var a=e.now(),b=(a-this._time)/1e3;this._time=a,this.game.config.showPreloader&&(this.game.video.clear(),this.game.preloading(b))},h.prototype.update=function(a){if(a>this.game.config.maxStepTime&&(a=this.game.config.maxStepTime),this.game.config.fixedStep)for(this.strayTime=this.strayTime+a;this.strayTime>=this.game.config.stepTime;)this.strayTime=this.strayTime-this.game.config.stepTime,this.game.states.update(this.game.config.stepTime);else this.game.states.update(a)},h.prototype.render=function(){this.game.video.beginFrame(),this.game.video.clear(),this.game.states.render(),this.game.video.endFrame()},b.exports=h},{"./game":28,"./input":29,"./raf-polyfill":31,"./state-manager":33,"./time":34,"potion-debugger":13}],28:[function(a,b){var c=a("./video"),d=a("./assets"),e=a("./retina"),f=function(a){this.canvas=a,this.width=this.canvas.width,this.height=this.canvas.height,this.assets=new d,this.isRetina=e(),this.states=null,this.debug=null,this.config={useRetina:!0,initializeCanvas:!0,initializeVideo:!0,addInputEvents:!0,showPreloader:!0,fixedStep:!0,stepTime:.01666,maxStepTime:.06},this.configure(),this.input=null,this.config.initializeVideo&&(this.video=new c(a,this.config),this.config.useRetina&&this.isRetina&&this.video.scaleCanvas(2))};f.prototype.init=function(){},f.prototype.configure=function(){},f.prototype.render=function(){},f.prototype.update=function(){},f.prototype.exitUpdate=function(){},f.prototype.setSize=function(a,b){this.width=a,this.height=b,this.video.setSize(a,b,!0),this.states.resize()},f.prototype.preloading=function(a){if((this.config.showPreloader||this.video&&this.video.ctx)&&this.video.ctx){void 0===this._preloaderWidth&&(this._preloaderWidth=0);var b=Math.min(2*this.width/3,300),c=20,d=(this.height-c)/2,e=(this.width-b)/2,f=b*this.assets.progress;this._preloaderWidth=this._preloaderWidth+(f-this._preloaderWidth)*a*10,this.video.ctx.save(),this.video.ctx.fillStyle="#a9c848",this.video.ctx.fillRect(0,0,this.width,this.height),this.video.ctx.fillStyle="#88a237",this.video.ctx.fillRect(e,d,b,c),this.video.ctx.fillStyle="#f6ffda",this.video.ctx.fillRect(e,d,this._preloaderWidth,c),this.video.ctx.restore()}},f.prototype.focus=function(){},f.prototype.blur=function(){},f.prototype.click=function(){},f.prototype.mousemove=function(){},f.prototype.mousedown=function(){},f.prototype.mouseup=function(){},f.prototype.keydown=function(){},f.prototype.keyup=function(){},f.prototype.resize=function(){},b.exports=f},{"./assets":26,"./retina":32,"./video":36}],29:[function(a,b){var c=a("./keys"),d=function(a,b){this._container=b,this.keys={},this.canControlKeys=!0,this.mouse={isDown:!1,button:null,x:null,y:null},this._addEvents(a)};d.prototype.resetKeys=function(){this.keys={}},d.prototype.isKeyDown=function(a){if(null==a)return!1;if(this.canControlKeys){var b="number"==typeof a?a:c[a.toUpperCase()];return this.keys[b]}},d.prototype._addEvents=function(a){var b=this;b._container.addEventListener("mousemove",function(c){var d=void 0===c.offsetX?c.layerX-b._container.offsetLeft:c.offsetX,e=void 0===c.offsetY?c.layerY-b._container.offsetTop:c.offsetY;a.states.mousemove(d,e,c),b.mouse.x=d,b.mouse.y=e}),b._container.addEventListener("click",function(c){c.preventDefault();var d=void 0===c.offsetX?c.layerX-b._container.offsetLeft:c.offsetX,e=void 0===c.offsetY?c.layerY-b._container.offsetTop:c.offsetY;a.states.click(d,e,c.button)}),b._container.addEventListener("mouseup",function(c){c.preventDefault();var d=void 0===c.offsetX?c.layerX-b._container.offsetLeft:c.offsetX,e=void 0===c.offsetY?c.layerY-b._container.offsetTop:c.offsetY;b.mouse.button=c.button,b.mouse.isDown=!1,a.states.mouseup(d,e,c.button)},!1),b._container.addEventListener("mousedown",function(c){c.preventDefault();var d=void 0===c.offsetX?c.layerX-b._container.offsetLeft:c.offsetX,e=void 0===c.offsetY?c.layerY-b._container.offsetTop:c.offsetY;b.mouse.x=d,b.mouse.y=e,b.mouse.button=c.button,b.mouse.isDown=!0,a.states.mousedown(d,e,c.button)},!1);var c=null,d=null;b._container.addEventListener("touchstart",function(a){var e=a.layerX,f=a.layerY;c=e,d=f,b.mouse.x=e,b.mouse.y=f,b.mouse.isDown=!0}),b._container.addEventListener("touchmove",function(c){c.preventDefault();var d=c.layerX,e=c.layerY;a.states.mousemove(d,e,c),b.mouse.x=d,b.mouse.y=e}),b._container.addEventListener("touchend",function(e){e.preventDefault(),b.mouse.isDown=!1;for(var f=0,g=e.changedTouches.length;g>f;f++){var h=e.changedTouches[f],i=h.pageX-b._container.offsetLeft,j=h.pageY-b._container.offsetTop,k=0,l=Math.abs(c-i),m=Math.abs(d-j),n=5;n>l&&n>m&&(b.mouse.x=i,b.mouse.y=j,a.states.click(i,j,k))}}),b._container.addEventListener("contextmenu",function(a){a.preventDefault()}),document.addEventListener("keydown",function(b){a.input.keys[b.keyCode]=!0,a.states.keydown(b.which,b)}),document.addEventListener("keyup",function(b){a.input.keys[b.keyCode]=!1,a.states.keyup(b.which,b)}),document.addEventListener("keypress",function(b){a.states.keypress(b.which,b)})},b.exports=d},{"./keys":30}],30:[function(a,b){b.exports={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190}},{}],31:[function(a,b){b.exports=function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}},{}],32:[function(a,b){var c=function(){var a="(-webkit-min-device-pixel-ratio: 1.5),  (min--moz-device-pixel-ratio: 1.5),  (-o-min-device-pixel-ratio: 3/2),  (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(a).matches?!0:!1};b.exports=c},{}],33:[function(a,b){var c=function(){this.states={},this.renderOrder=[],this.updateOrder=[]};c.prototype.add=function(a,b){return this.states[a]=this._newStateHolder(a,b),this.refreshOrder(),b};var d=function(a,b){return a.renderOrder<b.renderOrder},e=function(a,b){return a.updateOrder<b.updateOrder};c.prototype.refreshOrder=function(){this.renderOrder.length=0,this.updateOrder.length=0;for(var a in this.states){var b=this.states[a];b&&(this.renderOrder.push(b),this.updateOrder.push(b))}this.renderOrder.sort(d),this.updateOrder.sort(e)},c.prototype._newStateHolder=function(a,b){var c={};return c.name=a,c.state=b,c.protect=!1,c.enabled=!0,c.paused=!1,c.render=!0,c.initialized=!1,c.updated=!1,c.updateOrder=0,c.renderOrder=0,c},c.prototype.setUpdateOrder=function(a,b){var c=this.get(a);c&&(c.updateOrder=b,this.refreshOrder())},c.prototype.setRenderOrder=function(a,b){var c=this.get(a);c&&(c.renderOrder=b,this.refreshOrder())},c.prototype.get=function(a){return this.states[a]},c.prototype.destroy=function(a){var b=this.get(a);b&&!b.protect&&(b.state.close&&b.state.close(),delete this.states[a],this.refreshOrder())},c.prototype.destroyAll=function(){for(var a=0,b=this.updateOrder.length;b>a;a++){var c=this.updateOrder[a];c.protect||(c.state.close&&c.state.close(),delete this.states[c.name])}this.refreshOrder()},c.prototype.update=function(a){for(var b=0,c=this.updateOrder.length;c>b;b++){var d=this.updateOrder[b];d&&d.enabled&&d.state.update&&!d.paused&&(!d.initialized&&d.state.init&&(d.initialized=!0,d.state.init()),d.state.update(a),d.updated=!0)}},c.prototype.exitUpdate=function(a){for(var b=0,c=this.updateOrder.length;c>b;b++){var d=this.updateOrder[b];d.enabled&&d.state.exitUpdate&&!d.paused&&d.state.exitUpdate(a)}},c.prototype.enable=function(a){var b=this.get(a);b&&(b.enabled||(b.state.enable&&b.state.enable(),b.enabled=!0,b.paused&&this.unpause(a)))},c.prototype.disable=function(a){var b=this.get(a);b&&b.enabled&&(b.state.disable&&b.state.disable(),b.enabled=!1)},c.prototype.render=function(){for(var a=0,b=this.renderOrder.length;b>a;a++){var c=this.renderOrder[a];c.enabled&&c.updated&&c.render&&c.state.render&&c.state.render()}},c.prototype.pause=function(a){var b=this.get(a);b&&(b.state.pause&&b.state.pause(),b.paused=!0)},c.prototype.unpause=function(a){var b=this.get(a);b&&(b.state.unpause&&b.state.unpause(),b.paused=!1)},c.prototype.protect=function(a){var b=this.get(a);b&&(b.protect=!0)},c.prototype.unprotect=function(a){var b=this.get(a);b&&(b.protect=!1)},c.prototype.mousemove=function(a,b,c){for(var d=0,e=this.updateOrder.length;e>d;d++){var f=this.updateOrder[d];f.enabled&&f.state.mousemove&&!f.paused&&f.state.mousemove(a,b,c)}},c.prototype.mouseup=function(a,b){for(var c=0,d=this.updateOrder.length;d>c;c++){var e=this.updateOrder[c];e.enabled&&e.state.mouseup&&!e.paused&&e.state.mouseup(a,b)}},c.prototype.mousedown=function(a,b,c){for(var d=0,e=this.updateOrder.length;e>d;d++){var f=this.updateOrder[d];f.enabled&&f.state.mousedown&&!f.paused&&f.state.mousedown(a,b,c)}},c.prototype.click=function(a,b,c){for(var d=0,e=this.updateOrder.length;e>d;d++){var f=this.updateOrder[d];f.enabled&&f.state.click&&!f.paused&&f.state.click(a,b,c)}},c.prototype.keypress=function(a){for(var b=0,c=this.updateOrder.length;c>b;b++){var d=this.updateOrder[b];d.enabled&&d.state.keypress&&!d.paused&&d.state.keypress(a)}},c.prototype.keyup=function(a){for(var b=0,c=this.updateOrder.length;c>b;b++){var d=this.updateOrder[b];d.enabled&&d.state.keyup&&!d.paused&&d.state.keyup(a)}},c.prototype.keydown=function(a){for(var b=0,c=this.updateOrder.length;c>b;b++){var d=this.updateOrder[b];d.enabled&&d.state.keydown&&!d.paused&&d.state.keydown(a)}},c.prototype.resize=function(){for(var a=0,b=this.updateOrder.length;b>a;a++){var c=this.updateOrder[a];c.enabled&&c.render&&c.state.resize&&c.state.resize()}},b.exports=c},{}],34:[function(a,b){b.exports=function(){return window.performance||Date}()},{}],35:[function(a,b,c){{var d=c.get=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onload=function(){b(this.response)},c.send()};c.getJSON=function(a,b){d(a,function(a){b(JSON.parse(a))})}}c.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)}},{}],36:[function(a,b){var c=a("./retina"),d=function(a,b){this.config=b,this.canvas=a,this.width=a.width,this.height=a.height,b.initializeCanvas&&(this.ctx=a.getContext("2d"))};d.prototype.include=function(a){for(var b in a)this[b]=a[b]},d.prototype.beginFrame=function(){},d.prototype.endFrame=function(){},d.prototype.scaleCanvas=function(a){this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",this.canvas.width*=a,this.canvas.height*=a,this.ctx&&this.ctx.scale(a,a)},d.prototype.setSize=function(a,b,c){this.width=a,this.height=b,c&&(this.canvas.parentElement.style.width=a+"px",this.canvas.parentElement.style.height=b+"px"),this.canvas.width=a,this.canvas.height=b},d.prototype.sprite=function(a,b,c,d,e,f,g){if(this.ctx){d=d||0,e=e||0,f=f||a.width,g=g||a.height,b=Math.floor(b),c=Math.floor(c);var h=f,i=g;a.src.match(/@2x.png$/)&&(h/=2,i/=2),this.ctx.drawImage(a,a.x+d,a.y+e,f,g,b,c,h,i)}},d.prototype.animation=function(a,b,c){this.ctx&&this.sprite(a.image,b,c,a.offsetX,a.offsetY,a.width,a.height)},d.prototype.clear=function(){this.ctx&&this.ctx.clearRect(0,0,this.width,this.height)},d.prototype.createLayer=function(a){a=a||{};var b=this.canvas.parentElement,e=document.createElement("canvas");e.width=b.clientWidth,e.height=b.clientHeight,e.style.position="absolute",e.style.top="0px",e.style.left="0px",b.appendChild(e);var f=new d(e,a);return a.useRetina&&c()&&f.scaleCanvas(2),f},b.exports=d},{"./retina":32}]},{},[1])(1)});