/**
* potion - v1.0.0
* Copyright (c) 2015, Jan Sedivy
*
* Potion is licensed under the MIT License.
*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Potion=e():t.Potion=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n=i(1);t.exports={init:function(t,e){var i=new n(t,e);return i.controller}}},function(t,e,i){"use strict";i(2)();var n=i(3),r=i(4),o=i(5),s=i(6),a=i(7),h=function(t,e){this.container=t,this.controller=new n(t),this.app=e,this.controller.main=this.app,this.app.app=this.controller,this.tickFunc=function(t){return function(){t.tick()}}(this),this.preloaderTickFunc=function(t){return function(){t._preloaderTick()}}(this),this.strayTime=0,this._time=0,setTimeout(function(){this.configureApp()}.bind(this),0)};h.prototype.configureApp=function(){this.app.configure&&this.app.configure(),this.controller.video.init(),this.controller.config.addInputEvents&&(this.controller.input=new s(this.controller)),this.controller.resize(this.controller.width,this.controller.height),this._setDefaultStates(),this._time=r.now(),this._preloaderVideo=this.controller.video.createLayer({allowHiDPI:!0,getCanvasContext:!0}),this._preloader=new a(this.controller),this.controller.assets.start(function(){window.cancelAnimationFrame(this.preloaderId),this._preloaderVideo.destroy(),this.start()}.bind(this)),this.controller.assets.isLoading&&this.controller.config.showPreloader&&(this.preloaderId=window.requestAnimationFrame(this.preloaderTickFunc))},h.prototype.addEvents=function(){var t=this;window.addEventListener("blur",function(){t.controller.input.resetKeys(),t.app.blur&&t.app.blur()}),window.addEventListener("focus",function(){t.controller.input.resetKeys(),t.app.focus&&t.app.focus()})},h.prototype.start=function(){this.controller.config.addInputEvents&&this.addEvents(),window.requestAnimationFrame(this.tickFunc)},h.prototype.tick=function(){window.requestAnimationFrame(this.tickFunc),this.controller.debug.begin();var t=r.now(),e=(t-this._time)/1e3;this._time=t,this.controller.debug.perf("update"),this.update(e),this.controller.debug.stopPerf("update"),this.controller.states.exitUpdate(e),this.controller.debug.perf("render"),this.render(),this.controller.debug.stopPerf("render"),this.controller.debug.render(),this.controller.debug.end()},h.prototype.update=function(t){if(t>this.controller.config.maxStepTime&&(t=this.controller.config.maxStepTime),this.controller.config.fixedStep)for(this.strayTime=this.strayTime+t;this.strayTime>=this.controller.config.stepTime;)this.strayTime=this.strayTime-this.controller.config.stepTime,this.controller.states.update(this.controller.config.stepTime);else this.controller.states.update(t)},h.prototype.render=function(){this.controller.video.beginFrame(),this.controller.video.clear(),this.controller.states.render(),this.controller.video.endFrame()},h.prototype._preloaderTick=function(){this.preloaderId=window.requestAnimationFrame(this.preloaderTickFunc);var t=r.now(),e=(t-this._time)/1e3;this._time=t,this.app.preloading?this.app.preloading(e,this._preloaderVideo):this._preloader.render(e,this._preloaderVideo)},h.prototype._setDefaultStates=function(){var t=new o;t.add("main",this.app),t.add("debug",this.controller.debug),t.protect("main"),t.protect("debug"),t.hide("debug"),this.controller.states=t},t.exports=h},function(t,e,i){"use strict";t.exports=function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),r=window.setTimeout(function(){e(i+n)},n);return t=i+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}},function(t,e,i){"use strict";var n=i(8),r=i(9),o=i(11),s=i(12),a=function(t){this.container=t,t.style.position="relative";var e=document.createElement("canvas");e.style.display="block",t.appendChild(e),this.canvas=e,this.width=300,this.height=300,this.audio=new s,this.assets=new r(this),this.states=null,this.input=null,this.config={allowHiDPI:!0,getCanvasContext:!0,addInputEvents:!0,showPreloader:!0,fixedStep:!1,stepTime:1/60,maxStepTime:1/60},this.video=new n(this,e,this.config),this.video._isRoot=!0,this.debug=new o(this)};a.prototype.resize=function(t,e){this.width=t,this.height=e,this.container.style.width=this.width+"px",this.container.style.height=this.height+"px",this.video&&this.video._resize(t,e),this.states&&this.states.resize()},t.exports=a},function(t,e,i){"use strict";t.exports=function(){return window.performance||Date}()},function(t,e,i){"use strict";var n=function(t,e){return t.renderOrder<e.renderOrder},r=function(t,e){return t.updateOrder<e.updateOrder},o=function(){this.states={},this.renderOrder=[],this.updateOrder=[],this._preventEvent=!1};o.prototype.add=function(t,e){return this.states[t]=this._newStateHolder(t,e),this.refreshOrder(),e},o.prototype.enable=function(t){var e=this.getHolder(t);e&&(e.enabled||(e.state.enable&&e.state.enable(),e.enabled=!0,e.changed=!0,e.paused&&this.unpause(t)))},o.prototype.disable=function(t){var e=this.getHolder(t);e&&e.enabled&&(e.state.disable&&e.state.disable(),e.changed=!0,e.enabled=!1)},o.prototype.hide=function(t){var e=this.getHolder(t);e&&e.enabled&&(e.changed=!0,e.render=!1)},o.prototype.show=function(t){var e=this.getHolder(t);e&&e.enabled&&(e.changed=!0,e.render=!0)},o.prototype.pause=function(t){var e=this.getHolder(t);e&&(e.state.pause&&e.state.pause(),e.changed=!0,e.paused=!0)},o.prototype.unpause=function(t){var e=this.getHolder(t);e&&(e.state.unpause&&e.state.unpause(),e.changed=!0,e.paused=!1)},o.prototype.protect=function(t){var e=this.getHolder(t);e&&(e.protect=!0)},o.prototype.unprotect=function(t){var e=this.getHolder(t);e&&(e.protect=!1)},o.prototype.refreshOrder=function(){this.renderOrder.length=0,this.updateOrder.length=0;for(var t in this.states){var e=this.states[t];e&&(this.renderOrder.push(e),this.updateOrder.push(e))}this.renderOrder.sort(n),this.updateOrder.sort(r)},o.prototype._newStateHolder=function(t,e){var i={};return i.name=t,i.state=e,i.protect=!1,i.enabled=!0,i.paused=!1,i.render=!0,i.initialized=!1,i.updated=!1,i.changed=!0,i.updateOrder=0,i.renderOrder=0,i},o.prototype.setUpdateOrder=function(t,e){var i=this.getHolder(t);i&&(i.updateOrder=e,this.refreshOrder())},o.prototype.setRenderOrder=function(t,e){var i=this.getHolder(t);i&&(i.renderOrder=e,this.refreshOrder())},o.prototype.destroy=function(t){var e=this.getHolder(t);e&&!e.protect&&(e.state.close&&e.state.close(),delete this.states[t],this.refreshOrder())},o.prototype.destroyAll=function(){for(var t=0,e=this.updateOrder.length;e>t;t++){var i=this.updateOrder[t];i.protect||(i.state.close&&i.state.close(),delete this.states[i.name])}this.refreshOrder()},o.prototype.getHolder=function(t){return this.states[t]},o.prototype.get=function(t){return this.states[t].state},o.prototype.update=function(t){for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];n&&(n.changed=!1,n.enabled&&(!n.initialized&&n.state.init&&(n.initialized=!0,n.state.init()),n.state.update&&!n.paused&&(n.state.update(t),n.updated=!0)))}},o.prototype.exitUpdate=function(t){for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];n&&n.enabled&&n.state.exitUpdate&&!n.paused&&n.state.exitUpdate(t)}},o.prototype.render=function(){for(var t=0,e=this.renderOrder.length;e>t;t++){var i=this.renderOrder[t];i&&i.enabled&&(i.updated||!i.state.update)&&i.render&&i.state.render&&i.state.render()}},o.prototype.mousemove=function(t){this._preventEvent=!1;for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];if(n&&n.enabled&&!n.changed&&n.state.mousemove&&!n.paused&&n.state.mousemove(t),this._preventEvent)break}},o.prototype.mouseup=function(t){this._preventEvent=!1;for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];if(n&&n.enabled&&!n.changed&&n.state.mouseup&&!n.paused&&n.state.mouseup(t),this._preventEvent)break}},o.prototype.mousedown=function(t){this._preventEvent=!1;for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];if(n&&n.enabled&&!n.changed&&n.state.mousedown&&!n.paused&&n.state.mousedown(t),this._preventEvent)break}},o.prototype.keyup=function(t){this._preventEvent=!1;for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];if(n&&n.enabled&&!n.changed&&n.state.keyup&&!n.paused&&n.state.keyup(t),this._preventEvent)break}},o.prototype.keydown=function(t){this._preventEvent=!1;for(var e=0,i=this.updateOrder.length;i>e;e++){var n=this.updateOrder[e];if(n&&n.enabled&&!n.changed&&n.state.keydown&&!n.paused&&n.state.keydown(t),this._preventEvent)break}},o.prototype.resize=function(){for(var t=0,e=this.updateOrder.length;e>t;t++){var i=this.updateOrder[t];i&&i.enabled&&i.state.resize&&i.state.resize()}},t.exports=o},function(t,e,i){"use strict";var n=i(10),r={};for(var o in n)r[n[o]]=o;var s=function(t){this._container=t.container,this._keys={},this.canControlKeys=!0,this.mouse={isDown:!1,isLeftDown:!1,isMiddleDown:!1,isRightDown:!1,x:null,y:null,dx:0,dy:0},this._addEvents(t)};s.prototype.resetKeys=function(){this._keys={}},s.prototype.isKeyDown=function(t){if(null==t)return!1;if(this.canControlKeys){var e="number"==typeof t?t:n[t.toLowerCase()];return this._keys[e]}},s.prototype._addEvents=function(t){var e=this,i={x:null,y:null,button:null,isTouch:!1,event:null,stateStopEvent:function(){t.states._preventEvent=!0}},n={key:null,name:null,event:null,stateStopEvent:function(){t.states._preventEvent=!0}};e._container.addEventListener("mousemove",function(n){var r=void 0===n.offsetX?n.layerX-e._container.offsetLeft:n.offsetX,o=void 0===n.offsetY?n.layerY-e._container.offsetTop:n.offsetY;null!=e.mouse.x&&null!=e.mouse.x&&(e.mouse.dx=r-e.mouse.x,e.mouse.dy=o-e.mouse.y),e.mouse.x=r,e.mouse.y=o,e.mouse.isActive=!0,i.x=r,i.y=o,i.button=null,i.event=n,i.isTouch=!1,t.states.mousemove(i)}),e._container.addEventListener("mouseup",function(n){n.preventDefault();var r=void 0===n.offsetX?n.layerX-e._container.offsetLeft:n.offsetX,o=void 0===n.offsetY?n.layerY-e._container.offsetTop:n.offsetY;switch(n.button){case 0:e.mouse.isLeftDown=!1;break;case 1:e.mouse.isMiddleDown=!1;break;case 2:e.mouse.isRightDown=!1}e.mouse.isDown=e.mouse.isLeftDown||e.mouse.isRightDown||e.mouse.isMiddleDown,i.x=r,i.y=o,i.button=n.button,i.event=n,i.isTouch=!1,t.states.mouseup(i)},!1),e._container.addEventListener("mouseleave",function(){e.mouse.isActive=!1,e.mouse.isDown=!1,e.mouse.isLeftDown=!1,e.mouse.isRightDown=!1,e.mouse.isMiddleDown=!1}),e._container.addEventListener("mouseenter",function(){e.mouse.isActive=!0}),e._container.addEventListener("mousedown",function(n){n.preventDefault();var r=void 0===n.offsetX?n.layerX-e._container.offsetLeft:n.offsetX,o=void 0===n.offsetY?n.layerY-e._container.offsetTop:n.offsetY;switch(e.mouse.x=r,e.mouse.y=o,e.mouse.isDown=!0,e.mouse.isActive=!0,n.button){case 0:e.mouse.isLeftDown=!0;break;case 1:e.mouse.isMiddleDown=!0;break;case 2:e.mouse.isRightDown=!0}i.x=r,i.y=o,i.button=n.button,i.event=n,i.isTouch=!1,t.states.mousedown(i)},!1),e._container.addEventListener("touchstart",function(n){n.preventDefault();for(var r=0;r<n.touches.length;r++){var o=n.touches[r],s=o.pageX-e._container.offsetLeft,a=o.pageY-e._container.offsetTop;e.mouse.x=s,e.mouse.y=a,e.mouse.isDown=!0,e.mouse.isLeftDown=!0,e.mouse.isActive=!0,i.x=s,i.y=a,i.button=1,i.event=n,i.isTouch=!0,t.states.mousedown(i)}}),e._container.addEventListener("touchmove",function(n){n.preventDefault();for(var r=0;r<n.touches.length;r++){var o=n.touches[r],s=o.pageX-e._container.offsetLeft,a=o.pageY-e._container.offsetTop;null!=e.mouse.x&&null!=e.mouse.x&&(e.mouse.dx=s-e.mouse.x,e.mouse.dy=a-e.mouse.y),e.mouse.x=s,e.mouse.y=a,e.mouse.isDown=!0,e.mouse.isLeftDown=!0,e.mouse.isActive=!0,i.x=s,i.y=a,i.event=n,i.isTouch=!0,t.states.mousemove(i)}}),e._container.addEventListener("touchend",function(n){n.preventDefault();var r=n.changedTouches[0],o=r.pageX-e._container.offsetLeft,s=r.pageY-e._container.offsetTop;e.mouse.x=o,e.mouse.y=s,e.mouse.isActive=!1,e.mouse.isDown=!1,e.mouse.isLeftDown=!1,e.mouse.isRightDown=!1,e.mouse.isMiddleDown=!1,i.x=o,i.y=s,i.event=n,i.isTouch=!0,t.states.mouseup(i)}),e._container.addEventListener("contextmenu",function(t){t.preventDefault()}),document.addEventListener("keydown",function(i){e._keys[i.keyCode]=!0,n.key=i.which,n.name=r[i.which],n.event=i,t.states.keydown(n)}),document.addEventListener("keyup",function(i){e._keys[i.keyCode]=!1,n.key=i.which,n.name=r[i.which],n.event=i,t.states.keyup(n)})},t.exports=s},function(t,e,i){"use strict";var n=function(t){this.app=t,this.barWidth=0};n.prototype.render=function(t,e){e.clear();var i="#b9ff71",n="#8ac250",r="#648e38",o=Math.min(2*e.width/3,300),s=20,a=(e.height-s)/2,h=(e.width-o)/2,u=o*this.app.assets.progress;this.barWidth=this.barWidth+(u-this.barWidth)*t*10,e.ctx.fillStyle=n,e.ctx.fillRect(0,0,e.width,e.height),e.ctx.font="400 40px sans-serif",e.ctx.textAlign="center",e.ctx.textBaseline="bottom",e.ctx.fillStyle="rgba(0, 0, 0, 0.1)",e.ctx.fillText("Potion.js",e.width/2,a+2),e.ctx.fillStyle="#d1ffa1",e.ctx.fillText("Potion.js",e.width/2,a),e.ctx.strokeStyle=e.ctx.fillStyle=r,e.ctx.fillRect(h,a+15,o,s),e.ctx.lineWidth=2,e.ctx.beginPath(),e.ctx.rect(h-5,a+10,o+10,s+10),e.ctx.closePath(),e.ctx.stroke(),e.ctx.strokeStyle=e.ctx.fillStyle="rgba(0, 0, 0, 0.1)",e.ctx.fillRect(h,a+15,this.barWidth,s+2),e.ctx.lineWidth=2,e.ctx.beginPath(),e.ctx.moveTo(h+this.barWidth,a+12),e.ctx.lineTo(h-5,a+12),e.ctx.lineTo(h-5,a+10+s+12),e.ctx.lineTo(h+this.barWidth,a+10+s+12),e.ctx.stroke(),e.ctx.closePath(),e.ctx.strokeStyle=e.ctx.fillStyle=i,e.ctx.fillRect(h,a+15,this.barWidth,s),e.ctx.lineWidth=2,e.ctx.beginPath(),e.ctx.moveTo(h+this.barWidth,a+10),e.ctx.lineTo(h-5,a+10),e.ctx.lineTo(h-5,a+10+s+10),e.ctx.lineTo(h+this.barWidth,a+10+s+10),e.ctx.stroke(),e.ctx.closePath()},t.exports=n},function(t,e,i){"use strict";var n=i(17)(),r=function(t,e,i){this.app=t,this.config=i,this.canvas=e,this.width=t.width,this.height=t.height,this._parent=null,this._isRoot=!1,this._children=[]};r.prototype.init=function(){this.config.getCanvasContext&&(this.ctx=this.canvas.getContext("2d")),this._applySizeToCanvas()},r.prototype.include=function(t){for(var e in t)this[e]=t[e]},r.prototype.beginFrame=function(){},r.prototype.endFrame=function(){},r.prototype.destroy=function(){if(!this._isRoot){var t=this._parent._children.indexOf(this);-1!==t&&this._parent._children.splice(t,1)}this.canvas.parentElement.removeChild(this.canvas)},r.prototype.scaleCanvas=function(t){this.canvas.width*=t,this.canvas.height*=t,this.ctx&&this.ctx.scale(t,t)},r.prototype._resize=function(t,e){this.width=t,this.height=e,this._applySizeToCanvas();for(var i=0,n=this._children.length;n>i;i++){var r=this._children[i];r._resize(t,e)}},r.prototype._applySizeToCanvas=function(){this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.config.allowHiDPI&&n&&this.scaleCanvas(2)},r.prototype.clear=function(){this.ctx&&this.ctx.clearRect(0,0,this.width,this.height)},r.prototype.createLayer=function(t){t=t||{};var e=this.app.container,i=document.createElement("canvas");i.width=this.width,i.height=this.height,i.style.position="absolute",i.style.top="0px",i.style.left="0px",e.appendChild(i);var n=new r(this.app,i,t);return n._parent=this,n._isRoot=!1,n.init(),this._children.push(n),n},t.exports=r},function(t,e,i){"use strict";var n=i(18),r=i(19),o=i(13),s=i(14),a=i(15),h=function(t){this.isLoading=!1,this.itemsCount=0,this.progress=0,this._thingsToLoad=0,this._data={},this._preloading=!0,this._callback=null,this._toLoad=[],this._loaders={},this.addLoader("json",o);var e=i(16)(t.audio);this.addLoader("mp3",e),this.addLoader("music",e),this.addLoader("sound",e),this.addLoader("image",s),this.addLoader("texture",s),this.addLoader("sprite",s)};h.prototype.addLoader=function(t,e){this._loaders[t]=e},h.prototype.start=function(t){this._callback=t,this._toLoad.forEach(function(t){this._loadAssetFile(t,function(e,i){this.set(e,i),t.callback&&t.callback(i),this._finishedQueuedFile()}.bind(this))}.bind(this)),this._thingsToLoad=this.itemsCount,0===this._thingsToLoad&&this._done()},h.prototype.get=function(t){return this._data[r.normalize(t)]},h.prototype.set=function(t,e){this._data[r.normalize(t)]=e},h.prototype.remove=function(t){this.set(t,null)},h.prototype.load=function(t,e,i){var n={type:t,url:null!=e?r.normalize(e):null,callback:i,progress:0};this._preloading?this._queueFile(n):this._loadAssetFile(n,function(t,e){this.set(t,e),i&&i(e)}.bind(this))},h.prototype._queueFile=function(t){this.isLoading=!0,this.itemsCount+=1,this._toLoad.push(t)},h.prototype._finishedQueuedFile=function(){this._thingsToLoad-=1,0===this._thingsToLoad&&this._done()},h.prototype._updateProgress=function(){for(var t=0,e=0;e<this._toLoad.length;e++)t+=this._toLoad[e].progress;this.progress=t/this._toLoad.length},h.prototype._error=function(t){console.warn('Error loading "'+t+'" asset')},h.prototype._handleCustomLoading=function(t,e){t(function(t,i){e.done(i,t)})},h.prototype._loadAssetFile=function(t,e){var i=t.type,r=t.url,o={done:function(i,n){n=null==n?t.url:n,t.progress=1,e(n,i),this._updateProgress()}.bind(this),error:function(){this._error.bind(this)}.bind(this),progress:function(e){t.progress=e,this._updateProgress()}.bind(this)};if(n.isFunction(i))this._handleCustomLoading(i,o);else{i=i.toLowerCase();var s=this._loaders[i]||a;s(r,o)}},h.prototype._done=function(){this.isLoading=!1,this._preloading=!1,setTimeout(this._callback,0)},t.exports=h},function(t,e,i){"use strict";t.exports={backspace:8,tab:9,enter:13,pause:19,caps:20,esc:27,space:32,page_up:33,page_down:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,numpad_0:96,numpad_1:97,numpad_2:98,numpad_3:99,numpad_4:100,numpad_5:101,numpad_6:102,numpad_7:103,numpad_8:104,numpad_9:105,multiply:106,add:107,substract:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,shift:16,ctrl:17,alt:18,plus:187,comma:188,minus:189,period:190}},function(t,e,i){"use strict";t.exports=i(20)},function(t,e,i){"use strict";t.exports=i(21)},function(t,e,i){"use strict";t.exports=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="text",i.addEventListener("progress",function(t){var i=t.loaded/t.total;e.progress(i)}),i.onload=function(){if(200!==i.status)return e.error(t);var n=JSON.parse(this.response);e.done(n)},i.send()}},function(t,e,i){"use strict";t.exports=function(t,e){var i=window.URL||window.webkitURL;if(i&&"createObjectURL"in i&&"Uint8Array"in window&&"Blob"in window){var n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="arraybuffer",n.addEventListener("progress",function(t){var i=t.loaded/t.total;e.progress(i)}),n.onload=function(){if(200!==n.status)return e.error(t);var r=this.response,o=new Blob([new Uint8Array(r)],{type:"image/png"}),s=new Image;s.src=i.createObjectURL(o),e.done(s)},void n.send()}var r=new Image;r.onload=function(){e.done(r)},r.onerror=function(){e.error(t)},r.src=t}},function(t,e,i){"use strict";t.exports=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="text",i.addEventListener("progress",function(t){var i=t.loaded/t.total;e.progress(i)}),i.onload=function(){if(200!==i.status)return e.error(t);var n=this.response;e.done(n)},i.send()}},function(t,e,i){"use strict";t.exports=function(t){return function(e,i){t.load(e,{done:function(t){i.done(t)},progress:function(t){var e=t.loaded/t.total;i.progress(e)}})}}},function(t,e,i){"use strict";var n=function(){var t="(-webkit-min-device-pixel-ratio: 1.5),  (min--moz-device-pixel-ratio: 1.5),  (-o-min-device-pixel-ratio: 3/2),  (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(t).matches?!0:!1};t.exports=n},function(t,e,i){(function(t,n){"use strict";function r(t,i){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(i)?n.showHidden=i:i&&e._extend(n,i),x(n.showHidden)&&(n.showHidden=!1),x(n.depth)&&(n.depth=2),x(n.colors)&&(n.colors=!1),x(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),h(n,t,n.depth)}function o(t,e){var i=r.styles[e];return i?"["+r.colors[i][0]+"m"+t+"["+r.colors[i][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,i){e[t]=!0}),e}function h(t,i,n){if(t.customInspect&&i&&L(i.inspect)&&i.inspect!==e.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,t);return w(r)||(r=h(t,r,n)),r}var o=u(t,i);if(o)return o;var s=Object.keys(i),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(i)),T(i)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(i);if(0===s.length){if(L(i)){var v=i.name?": "+i.name:"";return t.stylize("[Function"+v+"]","special")}if(b(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(S(i))return t.stylize(Date.prototype.toString.call(i),"date");if(T(i))return c(i)}var m="",y=!1,_=["{","}"];if(f(i)&&(y=!0,_=["[","]"]),L(i)){var x=i.name?": "+i.name:"";m=" [Function"+x+"]"}if(b(i)&&(m=" "+RegExp.prototype.toString.call(i)),S(i)&&(m=" "+Date.prototype.toUTCString.call(i)),T(i)&&(m=" "+c(i)),0===s.length&&(!y||0==i.length))return _[0]+m+_[1];if(0>n)return b(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special");t.seen.push(i);var D;return D=y?p(t,i,n,g,s):s.map(function(e){return l(t,i,n,g,e,y)}),t.seen.pop(),d(D,m,_)}function u(t,e){if(x(e))return t.stylize("undefined","undefined");if(w(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return y(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,i,n,r){for(var o=[],s=0,a=e.length;a>s;++s)F(e,String(s))?o.push(l(t,e,i,n,String(s),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(l(t,e,i,n,r,!0))}),o}function l(t,e,i,n,r,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),F(n,r)||(s="["+r+"]"),a||(t.seen.indexOf(u.value)<0?(a=v(i)?h(t,u.value,null):h(t,u.value,i-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(s)){if(o&&r.match(/^\d+$/))return a;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function d(t,e,i){var n=0,r=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}function f(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function v(t){return null===t}function m(t){return null==t}function y(t){return"number"==typeof t}function w(t){return"string"==typeof t}function _(t){return"symbol"==typeof t}function x(t){return void 0===t}function b(t){return D(t)&&"[object RegExp]"===O(t)}function D(t){return"object"==typeof t&&null!==t}function S(t){return D(t)&&"[object Date]"===O(t)}function T(t){return D(t)&&("[object Error]"===O(t)||t instanceof Error)}function L(t){return"function"==typeof t}function k(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function O(t){return Object.prototype.toString.call(t)}function E(t){return 10>t?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),R[t.getMonth()],e].join(" ")}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var C=/%[sdj%]/g;e.format=function(t){if(!w(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(r(arguments[i]));return e.join(" ")}for(var i=1,n=arguments,o=n.length,s=String(t).replace(C,function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return t}}),a=n[i];o>i;a=n[++i])s+=v(a)||!D(a)?" "+a:" "+r(a);return s},e.deprecate=function(i,r){function o(){if(!s){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),s=!0}return i.apply(this,arguments)}if(x(t.process))return function(){return e.deprecate(i,r).apply(this,arguments)};if(n.noDeprecation===!0)return i;var s=!1;return o};var z,M={};e.debuglog=function(t){if(x(z)&&(z=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!M[t])if(new RegExp("\\b"+t+"\\b","i").test(z)){var i=n.pid;M[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,i,n)}}else M[t]=function(){};return M[t]},e.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=g,e.isNull=v,e.isNullOrUndefined=m,e.isNumber=y,e.isString=w,e.isSymbol=_,e.isUndefined=x,e.isRegExp=b,e.isObject=D,e.isDate=S,e.isError=T,e.isFunction=L,e.isPrimitive=k,e.isBuffer=i(24);var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=i(26),e._extend=function(t,e){if(!e||!D(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(e,function(){return this}(),i(25))},function(t,e,i){(function(t){"use strict";function i(t,e){for(var i=0,n=t.length-1;n>=0;n--){var r=t[n];"."===r?t.splice(n,1):".."===r?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return r.exec(t).slice(1)};e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,r="/"===s.charAt(0))}return e=i(n(e.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),o="/"===s(t,-1);return t=i(n(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,i){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=e.resolve(t).substr(1),i=e.resolve(i).substr(1);for(var r=n(t.split("/")),o=n(i.split("/")),s=Math.min(r.length,o.length),a=s,h=0;s>h;h++)if(r[h]!==o[h]){a=h;break}for(var u=[],h=a;h<r.length;h++)u.push("..");return u=u.concat(o.slice(a)),u.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=o(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},e.basename=function(t,e){var i=o(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},e.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(e,i(25))},function(t,e,i){"use strict";var n=i(18),r=i(22),o=[],s=function(){var t=o.pop();return t?t:{}},a=function(t){return 9>=t?48+t:10===t?48:t>10&&36>=t?64+(t-10):null},h=[{name:"Show FPS",entry:"showFps",defaults:!0},{name:"Show Key Codes",entry:"showKeyCodes",defaults:!0},{name:"Show Monitor Values",entry:"showMonitorValues",defaults:!0}],u=function(t){this.video=t.video.createLayer({allowHiDPI:!0,getCanvasContext:!0}),this.graph=t.video.createLayer({allowHiDPI:!1,getCanvasContext:!0}),this._graphHeight=100,this._60fpsMark=.8*this._graphHeight,this._msToPx=this._60fpsMark/16.66,this.app=t,this.options=h,this._maxLogsCounts=10;for(var e=0;e<this.options.length;e++){var i=this.options[e];this._initOption(i)}this.disabled=!1,this.fps=0,this.fpsCount=0,this.fpsElapsedTime=0,this.fpsUpdateInterval=.5,this._framePerf=[],this._fontSize=0,this._dirtyManager=new r(this.video.canvas,this.video.ctx),this.logs=[],this._perfValues={},this._perfNames=[],this.showDebug=!1,this.enableDebugKeys=!0,this.enableShortcuts=!1,this.enableShortcutsKey=220,this.lastKey="",this._monitor={},this._load(),this.keyShortcuts=[{key:123,entry:"showDebug",type:"toggle"}];var n=this;this.addConfig({name:"Show Performance Graph",entry:"showGraph",defaults:!1,call:function(){n.graph.clear()}}),this._diff=0,this._frameStart=0};u.prototype.begin=function(){this.showDebug&&(this._frameStart=window.performance.now())},u.prototype.end=function(){this.showDebug&&(this._diff=window.performance.now()-this._frameStart)},u.prototype._setFont=function(t,e){this._fontSize=t,this.video.ctx.font=t+"px "+e},u.prototype.addConfig=function(t){this.options.push(t),this._initOption(t)},u.prototype._initOption=function(t){t.type=t.type||"toggle",t.defaults=null==t.defaults?!1:t.defaults,"toggle"===t.type&&(this[t.entry]=t.defaults)},u.prototype.clear=function(){this.logs.length=0},u.prototype.log=function(t,e){e=e||"white",t="string"==typeof t?t:n.inspect(t);for(var i=t.replace(/\\'/g,"'").split("\n"),r=0;r<i.length;r++){var a=i[r];this.logs.length>=this._maxLogsCounts&&o.push(this.logs.shift());var h=s();h.text=a,h.life=10,h.color=e,this.logs.push(h)}},u.prototype.update=function(){},u.prototype.exitUpdate=function(t){if(!this.disabled&&this.showDebug){if(this._maxLogsCounts=Math.ceil((this.app.height+20)/20),this.fpsCount+=1,this.fpsElapsedTime+=t,this.fpsElapsedTime>this.fpsUpdateInterval){var e=this.fpsCount/this.fpsElapsedTime;this.showFps&&(this.fps=this.fps*(1-.8)+.8*e),this.fpsCount=0,this.fpsElapsedTime=0}for(var i=0,n=this.logs.length;n>i;i++){var r=this.logs[i];if(r&&(r.life-=t,r.life<=0)){var o=this.logs.indexOf(r);o>-1&&this.logs.splice(o,1)}}for(var i=0;i<this._perfNames.length;i++){var s=this._perfNames[i],a=this._perfValues[s];this.monitor(s,a.value.toFixed(3)+" sec")}}},u.prototype.keydown=function(t){if(!this.disabled){this.lastKey=t.key;var e;if(this.enableDebugKeys){if(t.key===this.enableShortcutsKey)return t.event.preventDefault(),this.enableShortcuts=!this.enableShortcuts,!0;if(this.enableShortcuts)for(e=0;e<this.options.length;e++){var i=this.options[e],n=e+1;this.app.input.isKeyDown("ctrl")&&(n-=36);var r=a(n);if(r&&t.key===r)return t.event.preventDefault(),"toggle"===i.type?(this[i.entry]=!this[i.entry],i.call&&i.call(),this._save()):"call"===i.type&&i.entry(),!0}}for(e=0;e<this.keyShortcuts.length;e++){var o=this.keyShortcuts[e];
if(o.key===t.key)return t.event.preventDefault(),"toggle"===o.type?(this[o.entry]=!this[o.entry],this._save()):"call"===o.type&&this[o.entry](),!0}return!1}},u.prototype._save=function(){for(var t={showDebug:this.showDebug,options:{}},e=0;e<this.options.length;e++){var i=this.options[e],n=this[i.entry];t.options[i.entry]=n}window.localStorage.__potionDebug=JSON.stringify(t)},u.prototype._load=function(){if(window.localStorage&&window.localStorage.__potionDebug){var t=JSON.parse(window.localStorage.__potionDebug);this.showDebug=t.showDebug;for(var e in t.options)this[e]=t.options[e]}},u.prototype.render=function(){if(!this.disabled&&(this._dirtyManager.clear(),this.showDebug)){if(this.video.ctx.save(),this._setFont(15,"sans-serif"),this._renderLogs(),this._renderData(),this._renderShortcuts(),this.video.ctx.restore(),this.showMonitorValues){var t=0;for(var e in this._monitor){var i=this._monitor[e];this._setFont(15,"sans-serif"),this.video.ctx.textAlign="right",this.video.ctx.textBaseline="bottom",this._renderText(e,this.app.width-14,this.app.height-28-5-40*t,"#e9dc7c"),i="string"==typeof i?i:n.inspect(i),this._renderText(i,this.app.width-14,this.app.height-14-40*t),t+=1}}if(this.showGraph){this.graph.ctx.drawImage(this.graph.canvas,0,this.app.height-this._graphHeight,this.app.width,this._graphHeight,-2,this.app.height-this._graphHeight,this.app.width,this._graphHeight),this.graph.ctx.fillStyle="#F2F0D8",this.graph.ctx.fillRect(this.app.width-2,this.app.height-this._graphHeight,2,this._graphHeight),this.graph.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.graph.ctx.fillRect(this.app.width-2,this.app.height-this._60fpsMark,2,1);for(var r=0,t=0;t<this._framePerf.length;t++){var o=this._framePerf[t],s=this._perfNames[t];this._drawFrameLine(o,s,r),r+=o}this._drawFrameLine(this._diff-r,"lag",r),this._framePerf.length=0}}},u.prototype._drawFrameLine=function(t,e,i){var n="black";"update"===e?n="#6BA5F2":"render"===e?n="#F27830":"lag"===e&&(n="#91f682"),this.graph.ctx.fillStyle=n;var r=(t+i)*this._msToPx,o=this.app.width-2,s=this.app.height-r;this.graph.ctx.fillRect(o,s,2,r-i*this._msToPx)},u.prototype._renderLogs=function(){this.video.ctx.textAlign="left",this.video.ctx.textBaseline="bottom";for(var t=0,e=this.logs.length;e>t;t++){var i=this.logs[t],n=-10+this.app.height+20*(t-this.logs.length+1);this._renderText(i.text,10,n,i.color)}},u.prototype.disable=function(){this.disabled=!0,this.showDebug=!1},u.prototype.monitor=function(t,e){this._monitor[t]=e},u.prototype.perf=function(t){if(this.showDebug){var e=this._perfValues[t];null==e&&(this._perfNames.push(t),this._perfValues[t]={name:t,value:0,records:[]});var i=window.performance.now(),n=this._perfValues[t];n.value=i}},u.prototype.stopPerf=function(t){if(this.showDebug){var e=this._perfValues[t],i=window.performance.now(),n=i-e.value;e.records.push(n),e.records.length>10&&e.records.shift();for(var r=0,o=0;o<e.records.length;o++)r+=e.records[o];var s=r/e.records.length;e.value=s,this._framePerf.push(n)}},u.prototype._renderData=function(){this.video.ctx.textAlign="right",this.video.ctx.textBaseline="top";var t=this.app.width-14,e=14;if(this.showFps&&this._renderText(Math.round(this.fps)+" fps",t,e),e+=24,this._setFont(15,"sans-serif"),this.showKeyCodes){var i="";this.app.input.mouse.isLeftDown?i="left":this.app.input.mouse.isRightDown?i="right":this.app.input.mouse.isMiddleDown&&(i="middle"),this._renderText("key "+this.lastKey,t,e,this.app.input.isKeyDown(this.lastKey)?"#e9dc7c":"white"),this._renderText("btn "+i,t-60,e,this.app.input.mouse.isDown?"#e9dc7c":"white")}},u.prototype._renderShortcuts=function(){if(this.enableShortcuts){var t=28;this._setFont(20,"Helvetica Neue, sans-serif"),this.video.ctx.textAlign="left",this.video.ctx.textBaseline="top";for(var e=Math.floor((this.app.height-14)/t),i=0;i<this.options.length;i++){var n=this.options[i],r=14+320*Math.floor(i/e),o=14+i%e*t,s=i+1,h=a(s),u=this[n.entry],c=String.fromCharCode(h);h||(c="^+"+String.fromCharCode(a(s-36)));var p="["+c+"] "+n.name;"toggle"===n.type?p+=" ("+(u?"ON":"OFF")+")":"call"===n.type&&(p+=" (CALL)");var l="rgba(255, 255, 255, 1)",d="rgba(0, 0, 0, 1)";u||(l="rgba(255, 255, 255, .7)",d="rgba(0, 0, 0, .7)"),this._renderText(p,r,o,l,d)}}},u.prototype._renderText=function(t,e,i,n,r){n=n||"white",r=r||"black",this.video.ctx.fillStyle=n,this.video.ctx.lineJoin="round",this.video.ctx.strokeStyle=r,this.video.ctx.lineWidth=3,this.video.ctx.strokeText(t,e,i),this.video.ctx.fillText(t,e,i);var o=this.video.ctx.measureText(t).width,s=e-5,a=i,h=o+10,u=this._fontSize+10;"right"===this.video.ctx.textAlign&&(s=e-5-o),this._dirtyManager.addRect(s,a,h,u)},t.exports=u},function(t,e,i){"use strict";var n=i(18),r=i(23),o=function(){var t=window.AudioContext||window.webkitAudioContext;this._ctx=new t,this._masterGain=this._ctx.createGain(),this._volume=1,this.isMuted=!1;var e=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);e&&this._enableiOS()};o.prototype._enableiOS=function(){var t=this,e=function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){var i=t._ctx.createBuffer(1,1,22050),n=t._ctx.createBufferSource();n.buffer=i,n.connect(t._ctx.destination),n.start(0),window.removeEventListener("touchstart",e,!1)});window.addEventListener("touchstart",e,!1)},o.prototype.mute=function(){this.isMuted=!0,this._updateMute()},o.prototype.unmute=function(){this.isMuted=!1,this._updateMute()},o.prototype.toggleMute=function(){this.isMuted=!this.isMuted,this._updateMute()},o.prototype._updateMute=function(){this._masterGain.gain.value=this.isMuted?0:this._volume},o.prototype.setVolume=function(t){this._volume=t,this._masterGain.gain.value=t},o.prototype.load=function(t,e){var i={done:function(){},error:function(){},progress:function(){}};e&&n.isFunction(e)?i.done=e:(e.done&&(i.done=e.done),e.error&&(i.error=e.error),e.progress&&(i.progress=e.progress));var r=this,o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.addEventListener("progress",function(t){i.progress(t)}),o.onload=function(){r.decodeAudioData(o.response,function(t){i.done(t)})},o.send()},o.prototype.decodeAudioData=function(t,e){var i=this;this._ctx.decodeAudioData(t,function(t){var n=new r(i._ctx,t,i._masterGain);e(n)})},t.exports=o},function(t,e,i){"use strict";var n=function(t,e){this.ctx=e,this.canvas=t,this.top=t.height,this.left=t.width,this.bottom=0,this.right=0,this.isDirty=!1};n.prototype.addRect=function(t,e,i,n){var r=t+i,o=e+n;this.top=e<this.top?e:this.top,this.left=t<this.left?t:this.left,this.bottom=o>this.bottom?o:this.bottom,this.right=r>this.right?r:this.right,this.isDirty=!0},n.prototype.clear=function(){this.isDirty&&(this.ctx.clearRect(this.left,this.top,this.right-this.left,this.bottom-this.top),this.left=this.canvas.width,this.top=this.canvas.height,this.right=0,this.bottom=0,this.isDirty=!1)},t.exports=n},function(t,e,i){"use strict";var n=i(27),r=function(t,e,i){this._ctx=t,this._masterGain=i,this._buffer=e,this._buffer.loop=!1};r.prototype._createSound=function(t){var e=this._ctx.createBufferSource();return e.buffer=this._buffer,this._masterGain.connect(this._ctx.destination),t.connect(this._masterGain),e.connect(t),e},r.prototype.play=function(){var t=this._ctx.createGain(),e=this._createSound(t);return e.start(0),new n(e,t)},r.prototype.fadeIn=function(t,e){var i=this._ctx.createGain(),r=this._createSound(i);return i.gain.setValueAtTime(0,0),i.gain.linearRampToValueAtTime(.01,0),i.gain.linearRampToValueAtTime(t,e),r.start(0),new n(r,i)},r.prototype.loop=function(){var t=this._ctx.createGain(),e=this._createSound(t);return e.loop=!0,e.start(0),new n(e,t)},t.exports=r},function(t,e,i){"use strict";t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,i){"use strict";function n(){if(!a){a=!0;for(var t,e=s.length;e;){t=s,s=[];for(var i=-1;++i<e;)t[i]();e=s.length}a=!1}}function r(){}var o=t.exports={},s=[],a=!1;o.nextTick=function(t){s.push(t),a||setTimeout(n,0)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,i){"use strict";"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){"use strict";var n=function(t,e){this._gain=e,this._source=t};n.prototype.setVolume=function(t){this._gain.gain.value=t},n.prototype.stop=function(){this._source.stop(0)},n.prototype.loop=function(){this._source.loop=!0},t.exports=n}])});